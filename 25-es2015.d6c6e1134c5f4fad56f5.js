(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{upr6:function(e,t,r){"use strict";r.r(t),r.d(t,"CheckoutdetailPageModule",(function(){return xe}));var n=r("ofXK"),i=r("3Pt+"),o=r("tyNb"),a=r("TEn/"),s=r("mrSG"),c=r("LeCc"),l=r("i2Ty"),d=r("dMTE"),b=r("rIxz"),g=r("ybIa"),u=r("+DAS"),p=r("z6cu"),m=r("IzEk"),y=r("PWOX"),h=r("sH8K"),f=r("0nTO"),v=r("cBbZ"),V=r("pRR6"),D=r("7o/Q");function W(e=-1){return t=>t.lift(new k(e,t))}class k{constructor(e,t){this.count=e,this.source=t}call(e,t){return t.subscribe(new S(e,this.count,this.source))}}class S extends D.a{constructor(e,t,r){super(e),this.count=t,this.source=r}error(e){if(!this.isStopped){const{source:t,count:r}=this;if(0===r)return super.error(e);r>-1&&(this.count=r-1),t.subscribe(this._unsubscribeAndRecycle())}}}var x=r("JIr8"),M=r("tk/3"),I=r("fXoL"),N=r("G2i7"),C=r("gAVi"),O=r("gren"),w=r("0IaG"),j=r("xHqg"),T=r("bTqV"),q=r("QibW"),P=r("kmnG"),F=r("qFsG"),K=r("/per"),L=r("gX7p"),A=r("B9HH"),R=r("6xI8"),E=r("sYmb");function z(e,t){if(1&e&&(I.Wb(0,"div",24),I.Rb(1,"app-callphone",25),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.rc("mobile",e.ygen.getSettings().oncallsupport)}}function Q(e,t){if(1&e){const e=I.Xb();I.Wb(0,"button",26),I.ec("click",(function(){I.Cc(e);const t=I.ic(3);return t.ygen.inviteviawhatsapp(t.ygen.getSettings().oncallwhatsappsupport,"Hi")})),I.Rb(1,"ion-icon",27),I.Vb()}}function H(e,t){if(1&e&&(I.Wb(0,"div",19),I.Wb(1,"h3"),I.Mc(2),I.jc(3,"translate"),I.Vb(),I.Wb(4,"p"),I.Mc(5),I.Vb(),I.Wb(6,"div",20),I.Wb(7,"div",21),I.Kc(8,z,2,1,"div",22),I.Kc(9,Q,2,0,"button",23),I.Vb(),I.Vb(),I.Vb()),2&e){const e=I.ic(2);I.Db(2),I.Nc(I.kc(3,4,"Store's Instructions")),I.Db(3),I.Nc(e.ygen.getSettings().checkoutordermsg),I.Db(3),I.rc("ngIf",e.ygen.getSettings().oncallsupport&&(""+e.ygen.getSettings().oncallsupport).length>1),I.Db(1),I.rc("ngIf",e.ygen.getSettings().oncallwhatsappsupport&&(""+e.ygen.getSettings().oncallwhatsappsupport).length>1)}}function _(e,t){if(1&e&&(I.Wb(0,"div",28),I.Rb(1,"ion-icon",29),I.Wb(2,"h3"),I.Mc(3),I.jc(4,"translate"),I.Vb(),I.Wb(5,"p"),I.Mc(6),I.Vb(),I.Rb(7,"app-callphone",25),I.Wb(8,"ion-button",30),I.Mc(9),I.jc(10,"translate"),I.Vb(),I.Vb()),2&e){const e=I.ic(2);I.Db(3),I.Nc(I.kc(4,4,"No more Orders or Shop Subscription Expired")),I.Db(3),I.Nc(e.ygen.getSettings().stopordersmessage),I.Db(1),I.rc("mobile",e.ygen.getSettings().oncallsupport),I.Db(2),I.Oc("",I.kc(10,6,"Come back again")," ")}}function U(e,t){1&e&&(I.Mc(0),I.jc(1,"translate")),2&e&&I.Nc(I.kc(1,1,"Pick your Delivery option"))}function B(e,t){1&e&&(I.Wb(0,"div"),I.Wb(1,"h1"),I.Mc(2,"No Delivery Options Setup by Store; You can not proceed further"),I.Vb(),I.Vb())}function Y(e,t){1&e&&(I.Wb(0,"mat-radio-button",33),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Oc(" ",I.kc(2,1,"Home Delivery"),""))}function G(e,t){1&e&&(I.Wb(0,"mat-radio-button",34),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Oc(" ",I.kc(2,1,"Store Pickup"),""))}function X(e,t){if(1&e&&(I.Wb(0,"mat-radio-group",13),I.Kc(1,Y,3,3,"mat-radio-button",31),I.Kc(2,G,3,3,"mat-radio-button",32),I.Vb()),2&e){const e=I.ic(2);I.rc("formControl",e.deliveryType),I.Db(1),I.rc("ngIf",e.ygen.getSettings().onlyhomepickup),I.Db(1),I.rc("ngIf",e.ygen.getSettings().onlystorepickup)}}function $(e,t){1&e&&(I.Mc(0),I.jc(1,"translate")),2&e&&I.Nc(I.kc(1,1,"Pick your Payment option"))}function J(e,t){1&e&&(I.Wb(0,"mat-radio-button",35),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Oc(" ",I.kc(2,1,"Cash on Delivery"),""))}function Z(e,t){1&e&&(I.Wb(0,"mat-radio-button",36),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Oc(" ",I.kc(2,1,"Pay Now")," "))}function ee(e,t){1&e&&I.Mc(0,"More Details")}function te(e,t){1&e&&(I.Wb(0,"legend"),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Nc(I.kc(2,1,"Your Details")))}function re(e,t){1&e&&(I.Wb(0,"legend"),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Nc(I.kc(2,1,"Delivery Address")))}function ne(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.userName,"Name"),"")}}function ie(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.mobile,"mobile"),"")}}function oe(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.unitName,"Building Name"),"")}}function ae(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.address,"Address"),"")}}function se(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.city,"City"),"")}}function ce(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.state,"State"),"")}}function le(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.zip,"Postal Code"),"")}}function de(e,t){if(1&e&&(I.Wb(0,"mat-error"),I.Mc(1),I.Vb()),2&e){const e=I.ic(3);I.Db(1),I.Oc(" ",e.getErrorMessage(e.addressForm.controls.country,"Country"),"")}}const be=function(){return["in"]};function ge(e,t){if(1&e){const e=I.Xb();I.Wb(0,"div"),I.Wb(1,"form",37),I.Wb(2,"fieldset"),I.Kc(3,te,3,3,"legend",4),I.Kc(4,re,3,3,"legend",4),I.Wb(5,"table",38),I.Wb(6,"tr"),I.Wb(7,"td"),I.Wb(8,"mat-form-field",17),I.Wb(9,"mat-label"),I.Mc(10),I.jc(11,"translate"),I.Vb(),I.Rb(12,"input",39),I.Kc(13,ne,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Wb(14,"tr"),I.Wb(15,"td"),I.Wb(16,"mat-form-field",17),I.Rb(17,"ngx-mat-intl-tel-input",40),I.jc(18,"translate"),I.Wb(19,"mat-hint"),I.Mc(20),I.jc(21,"translate"),I.Vb(),I.Kc(22,ie,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Wb(23,"tr"),I.Wb(24,"td"),I.Wb(25,"mat-form-field",17),I.Wb(26,"mat-label"),I.Mc(27),I.jc(28,"translate"),I.Vb(),I.Rb(29,"input",41),I.Kc(30,oe,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Wb(31,"p"),I.Wb(32,"mat-form-field",17),I.Wb(33,"mat-label"),I.Mc(34),I.jc(35,"translate"),I.Vb(),I.Wb(36,"textarea",42),I.Mc(37,"\n                  "),I.Vb(),I.Kc(38,ae,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Wb(39,"table",38),I.Wb(40,"tr"),I.Wb(41,"td"),I.Wb(42,"mat-form-field",17),I.Wb(43,"mat-label"),I.Mc(44),I.jc(45,"translate"),I.Vb(),I.Rb(46,"input",43),I.Kc(47,se,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Wb(48,"td"),I.Wb(49,"mat-form-field",17),I.Wb(50,"mat-label"),I.Mc(51),I.jc(52,"translate"),I.Vb(),I.Rb(53,"input",44),I.Kc(54,ce,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Wb(55,"tr"),I.Wb(56,"td"),I.Wb(57,"mat-form-field",17),I.Wb(58,"mat-label"),I.Mc(59),I.jc(60,"translate"),I.Vb(),I.Rb(61,"input",45,46),I.Wb(63,"mat-hint",47),I.Mc(64),I.Vb(),I.Kc(65,le,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Wb(66,"tr"),I.Wb(67,"td"),I.Wb(68,"mat-form-field",48),I.Rb(69,"input",49,50),I.Vb(),I.Wb(71,"mat-select-country",51),I.ec("onCountrySelected",(function(t){I.Cc(e);const r=I.ic(2);return r.onCountrySelected(t,r.addressForm.controls.country)})),I.Vb(),I.Kc(72,de,2,1,"mat-error",4),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Vb()}if(2&e){const e=I.zc(62),t=I.zc(70),r=I.ic(2);I.Db(1),I.rc("formGroup",r.addressForm),I.Db(2),I.rc("ngIf",r.isrequiredAddressForm()),I.Db(1),I.rc("ngIf",!r.isrequiredAddressForm()),I.Db(6),I.Nc(I.kc(11,27,"Name")),I.Db(3),I.rc("ngIf",r.addressForm.controls.userName.invalid),I.Db(4),I.sc("placeholder",I.kc(18,29,"mobile")),I.rc("cssClass","custom")("preferredCountries",I.uc(43,be))("enablePlaceholder",!0)("enableSearch",!0)("formControl",r.addressForm.controls.mobile)("required",!0),I.Db(3),I.Nc(I.kc(21,31,"Your Mobile..")),I.Db(2),I.rc("ngIf",r.addressForm.controls.mobile.invalid),I.Db(5),I.Nc(I.kc(28,33,"Building Name")),I.Db(3),I.rc("ngIf",r.addressForm.controls.unitName.invalid),I.Db(4),I.Nc(I.kc(35,35,"Address")),I.Db(4),I.rc("ngIf",r.addressForm.controls.address.invalid),I.Db(6),I.Nc(I.kc(45,37,"City")),I.Db(3),I.rc("ngIf",r.addressForm.controls.city.invalid),I.Db(4),I.Nc(I.kc(52,39,"State")),I.Db(3),I.rc("ngIf",r.addressForm.controls.state.invalid),I.Db(5),I.Nc(I.kc(60,41,"Postal Code")),I.Db(5),I.Oc("",e.value.length,"/5"),I.Db(1),I.rc("ngIf",r.addressForm.controls.zip.invalid),I.Db(6),I.rc("country",t.value),I.Db(1),I.rc("ngIf",r.addressForm.controls.country.invalid)}}function ue(e,t){1&e&&(I.Wb(0,"div",28),I.Rb(1,"ion-icon",29),I.Wb(2,"h3"),I.Mc(3),I.jc(4,"translate"),I.Vb(),I.Wb(5,"p"),I.Mc(6),I.jc(7,"translate"),I.Vb(),I.Wb(8,"ion-button",30),I.Mc(9),I.jc(10,"translate"),I.Vb(),I.Vb()),2&e&&(I.Db(3),I.Nc(I.kc(4,3,"Your Cart is Empty")),I.Db(3),I.Nc(I.kc(7,5,"Lets get you started")),I.Db(3),I.Oc("",I.kc(10,7,"Start shopping")," "))}function pe(e,t){if(1&e&&(I.Wb(0,"ion-content",5),I.Kc(1,H,10,6,"div",6),I.Kc(2,_,11,8,"div",7),I.Wb(3,"mat-vertical-stepper",8,9),I.Wb(5,"mat-step"),I.Kc(6,U,2,3,"ng-template",10),I.Wb(7,"div"),I.Wb(8,"div"),I.Wb(9,"div"),I.Kc(10,B,3,0,"div",4),I.Kc(11,X,3,3,"mat-radio-group",11),I.Vb(),I.Vb(),I.Vb(),I.Wb(12,"div"),I.Wb(13,"button",12),I.Mc(14,"Next"),I.Vb(),I.Vb(),I.Vb(),I.Wb(15,"mat-step"),I.Kc(16,$,2,3,"ng-template",10),I.Wb(17,"div"),I.Wb(18,"div"),I.Wb(19,"div"),I.Wb(20,"mat-radio-group",13),I.Kc(21,J,3,3,"mat-radio-button",14),I.Kc(22,Z,3,3,"mat-radio-button",15),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Wb(23,"div"),I.Wb(24,"button",12),I.Mc(25,"Next"),I.Vb(),I.Vb(),I.Vb(),I.Wb(26,"mat-step"),I.Kc(27,ee,1,0,"ng-template",10),I.Wb(28,"div"),I.Wb(29,"form",16),I.Wb(30,"fieldset"),I.Wb(31,"legend"),I.Mc(32),I.jc(33,"translate"),I.Vb(),I.Wb(34,"mat-form-field",17),I.Wb(35,"mat-label"),I.Mc(36),I.jc(37,"translate"),I.Vb(),I.Rb(38,"textarea",18),I.Vb(),I.Vb(),I.Vb(),I.Kc(39,ge,73,44,"div",4),I.Vb(),I.Vb(),I.Vb(),I.Kc(40,ue,11,9,"div",7),I.Vb()),2&e){const e=I.ic();I.Db(1),I.rc("ngIf",e.ygen.getSettings().checkoutordermsg&&e.ygen.getSettings().checkoutordermsg.length>0),I.Db(1),I.rc("ngIf",e.ygen.getSettings().stoporders||!e.ygen.isActiveSubscription()),I.Db(1),I.rc("linear",!1),I.Db(7),I.rc("ngIf",!(e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup)),I.Db(1),I.rc("ngIf",e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup),I.Db(9),I.rc("formControl",e.paymentType),I.Db(1),I.rc("ngIf",e.ygen.getSettings().offercod),I.Db(1),I.rc("ngIf",e.ygen.getSettings().onlinepay),I.Db(10),I.Nc(I.kc(33,13,"Delivery Note/Instruction")),I.Db(4),I.Nc(I.kc(37,15,"Leave a note/instruction about order")),I.Db(2),I.rc("formControl",e.deliveryNote),I.Db(1),I.rc("ngIf","HD"==e.deliveryType.value||e.isrequiredAddressForm()),I.Db(1),I.rc("ngIf",0==e.ycat.getcartcount())}}function me(e,t){if(1&e&&(I.Wb(0,"ion-toolbar"),I.Wb(1,"div",53),I.Wb(2,"ion-text"),I.Wb(3,"h3"),I.Mc(4),I.jc(5,"translate"),I.Vb(),I.Vb(),I.Wb(6,"ion-text"),I.Wb(7,"h3"),I.Mc(8),I.Vb(),I.Vb(),I.Vb(),I.Vb()),2&e){const e=I.ic(2);I.Db(4),I.Nc(I.kc(5,2,"Delivery Charges")),I.Db(4),I.Oc(" \u20b9 ",e.ygen.getSettings().deliverycharges," ")}}function ye(e,t){if(1&e){const e=I.Xb();I.Wb(0,"ion-button",57),I.ec("click",(function(){I.Cc(e);const t=I.ic(3);return t.payoptions(t.ycat.getcart())})),I.Mc(1),I.jc(2,"translate"),I.Vb()}if(2&e){const e=I.ic(3);I.rc("disabled",e.isReady()),I.Db(1),I.Oc(" ",I.kc(2,2,"Complete Order"),"")}}function he(e,t){1&e&&(I.Wb(0,"ion-button",58),I.Mc(1),I.jc(2,"translate"),I.Vb()),2&e&&(I.Db(1),I.Oc(" ",I.kc(2,1,"No More Orders"),""))}function fe(e,t){if(1&e&&(I.Wb(0,"ion-toolbar",0),I.Wb(1,"div",54),I.Wb(2,"ion-text"),I.Wb(3,"h3"),I.Mc(4),I.jc(5,"translate"),I.Vb(),I.Vb(),I.Kc(6,ye,3,4,"ion-button",55),I.Kc(7,he,3,3,"ion-button",56),I.Wb(8,"ion-text"),I.Wb(9,"h3"),I.Mc(10),I.Vb(),I.Vb(),I.Vb(),I.Vb()),2&e){const e=I.ic(2);I.rc("color","warning"),I.Db(4),I.Nc(I.kc(5,5,"Total")),I.Db(2),I.rc("ngIf",!e.ygen.getSettings().stoporders&&e.ygen.isActiveSubscription()),I.Db(1),I.rc("ngIf",e.ygen.getSettings().stoporders&&!e.ygen.isActiveSubscription()),I.Db(3),I.Oc(" \u20b9 ",e.getTotal()," ")}}function ve(e,t){if(1&e&&(I.Wb(0,"ion-footer"),I.Kc(1,me,9,4,"ion-toolbar",4),I.Kc(2,fe,11,7,"ion-toolbar",52),I.Vb()),2&e){const e=I.ic();I.Db(1),I.rc("ngIf","HD"==e.deliveryType.value&&!e.ygen.getSettings().freedelivery&&e.ygen.getSettings().freedeliveryoveramount&&e.ygen.getSettings().freedeliveryamount>e.ycat.getTotal()||!e.ygen.getSettings().freedeliveryoveramount&&!e.ygen.getSettings().freedelivery),I.Db(1),I.rc("ngIf",e.ycat.getcartcount()>0)}}let Ve=(()=>{class e{constructor(e,t,r,n,i,o,a,s,c,l,d,b,u,p,m){this.centerdb=e,this.http=t,this.ngxUiLoaderService=r,this.ynotification=n,this.yovalidation=i,this.yauth=o,this.ydata=a,this.router=s,this.ygen=c,this.events=l,this.ycat=d,this.alertme=b,this.ypaytm=u,this.ypay=p,this.dialog=m,this.centerdb.currenttenant.subscribe(e=>{e&&(this.orderlist=new g.a(N.a.getpath()+"/shop/orders",this.ydata.getDatabase(),!0,this.ygen.getUid()))})}buildForm(e){let t=e.country?e.country:"India",r=e.mobile?e.mobile:this.yauth.myprofile.mobile;var n;this.addressForm=new i.g({userName:new i.d(e.userName,[i.v.required,i.v.minLength(2),i.v.maxLength(30)]),mobile:new i.d(r,[i.v.required,i.v.minLength(2),i.v.maxLength(30)]),unitName:new i.d(e.unitName,[i.v.required,i.v.minLength(2),i.v.maxLength(30)]),address:new i.d(e.address,[i.v.required,i.v.minLength(2),i.v.maxLength(100)]),city:new i.d(e.city,[i.v.required,i.v.minLength(2),i.v.maxLength(30)]),state:new i.d(e.state,[i.v.required,i.v.minLength(2),i.v.maxLength(30)]),zip:new i.d(e.zip,{validators:[i.v.required,i.v.minLength(2),i.v.maxLength(30)],asyncValidators:[(n=this.ygen,e=>n.isdeliverabletopin(e.value).then(e=>e?null:{notdeliverable:!0}))],updateOn:"blur"}),country:new i.d(t,{validators:[i.v.required,i.v.minLength(2),i.v.maxLength(30)]})});let o="HD";this.ygen.getSettings().onlystorepickup&&(o="SP"),this.ygen.getSettings().onlystorepickup||this.ygen.getSettings().onlyhomepickup||(o=""),this.deliveryType=new i.d(o,[i.v.required,i.v.max(2)]),setTimeout(()=>{this.paymentType.setValue(o)},100);let a="COD";this.ygen.getSettings().onlinepay&&(a="PNO"),this.ygen.getSettings().onlinepay||this.ygen.getSettings().offercod||(a=""),this.paymentType=new i.d(a,[i.v.required,i.v.max(3)]),setTimeout(()=>{this.paymentType.setValue(a)},100),this.deliveryNote=new i.d("Thanks",[i.v.required,i.v.max(100)]),this.addressForm.controls.mobile.setValue(r),this.addressForm.controls.country.setValue(t)}isrequiredAddressForm(){return!(!this.payer||this.payer.userName&&this.payer.mobile)}ngOnInit(){this.ynotification.getStoreAdmins(),this.ygen.getUid()?this.getUserProfile().then(e=>{this.ngxUiLoaderService.stop(),this.payer=e,this.payer?this.buildForm(this.payer):(console.error("blank form"),this.buildForm({}))}).finally(()=>{this.ngxUiLoaderService.stop()}):(this.yauth.setlanding("/checkoutdetail"),this.router.navigate(["/login"],{}))}getUserProfile(){return Object(s.a)(this,void 0,void 0,(function*(){this.ngxUiLoaderService.start();const e=yield this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).valueChanges().pipe(Object(m.a)(1)).toPromise();return yield e}))}addtocart(e,t,r){r&&(t.orderqty=0);let n=t.orderqty?t.orderqty+e:1;n>t.maxqty?this.alertme.openSnackBar(`Maximum quantiy you can order is ${t.maxqty}`,"Ok"):(Object.assign(t,{orderqty:n}),this.ycat.iscartItem(t)?this.ycat.updatequantity(t):1==n&&(this.alertme.openSnackBar(`Your shopping cart updated with ${t.orderqty} quantity`,"Ok"),this.ycat.addtocart(t))),0==t.orderqty&&this.ycat.delete(t)}pay(e){let t=""+ +new Date,r=this.ygen.randomletter()+this.ygen.randomletter()+~~(1e3*Math.random())+t.substring(t.length-4);e.forEach(e=>{e.$key?e.originalkey=e.$key:console.warn("no Key.."),delete e.$key});let n={sendorderid:r,isorder:!0,payload:e,amount:this.getTotal(),orderByName:this.addressForm.controls.userName.value,orderByPhone:this.addressForm.controls.mobile.value,deliveryAddress:this.ygen.getAddress(this.addressForm.value),storeAddress:this.ygen.getAddress(C.a.selectedtenant),wheredelivery:this.deliveryType.value,deliverynote:this.deliveryNote.value,storename:this.ygen.communityName(),orderedBy:this.payer.uid,gateway:"?"};"INVALID"!=this.addressForm.status&&this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).update(this.addressForm.value),this.events.subscribe("order:success["+r+"]",e=>{this.yauth.setlanding(null),this.events.unsubscribe("order:success["+r+"]"),this.ygen.findDistanceForOrder(n.deliveryAddress,!0);let t=this.ydata.getDatabase().createPushId();e.key=t,this.orderlist.getListRefer().set(t,e),this.ynotification.sendNotificationToTakeUser(this.payer.uid,{message:"Order Successfully placed with, OrderID=["+r+"]",path:"order?orderid="+t},"Order Success",!0,!0,!0),this.alertme.successdata("Order Successfully placed with, OrderID=["+r+"]").then(e=>{console.log("done",e)}),"razorpay"==n.gateway&&this.capturepayment(n),this.router.navigate(["/order"],{queryParams:{orderid:t,orderkey:r,orderplaced:!0}}),this.ycat.emptycart(),this.ycat.updateProductQuantity()}),"COD"==this.paymentType.value?(n.paymentmethod="COD",Object.assign(n,{orderedBy:this.payer.uid,odt:+new Date,ostatus:"NEW"}),this.events.publish("order:success["+n.sendorderid+"]",n)):this.ygen.getSettings().usepaytm?(n.gateway="paytm",this.ypaytm.pay(n)):this.ygen.getSettings().userazorpay?(n.gateway="razorpay",this.ypay.pay(n)):this.alertme.errordata("No Payment Gateway Options enabled")}onCountrySelected(e,t){t.setValue(e.name)}payoptions(e){this.pay(e)}getErrorMessage(e,t){let r="",n=this.getMeErrors({placeholder:t});return Object.keys(n).some(t=>{if(e.errors[t])return r=n[t],!0}),r}getMeErrors(e){return this.yovalidation.genericErrors(e)}getTotal(){let e=this.ycat.getTotal();return"HD"!=this.deliveryType.value||this.ygen.getSettings().freedelivery||(this.ygen.getSettings().freedeliveryoveramount&&this.ygen.getSettings().freedeliveryamount>this.ycat.getTotal()?e+=this.ygen.getSettings().deliverycharges:this.ygen.getSettings().freedeliveryoveramount||(e+=this.ygen.getSettings().deliverycharges)),e}isReady(){let e=!0;return"HD"==this.deliveryType.value?e=!this.addressForm.valid:"SP"==this.deliveryType.value&&(e=this.isrequiredAddressForm()&&!this.addressForm.valid),e}capturepayment(e){let t=e.key,r=this.yauth.getappSettings(),n=r.testonlinepay;r.testonlinepay||(n=!1);let i=`https://guarded-sea-64699.herokuapp.com/rest/razor/capture?testmode=${n}&paymentid=${e.paymentResponse.payment_id}`,o={amount:100*e.amount,currency:"INR"};const a={headers:new M.d({"Content-Type":"application/json",Authorization:"yoyo"})};this.http.post(i,o,a).pipe(W(2)).subscribe(e=>{let r={paymentcaptured:!0,paymentcaptureddetail:e};console.log("capture payment",e),e.err||this.orderlist.getListRefer().update(t,r)},e=>{let r={paymentcaptured:!1,paymentcaptureddetail:e};this.orderlist.getListRefer().update(t,r)})}createpickup(e){if(this.ygen.getSettings().deliveryenabled){let t=+new Date,r={pickup_time:this.ygen.getTimeinformat(t,"HH:mm:ss"),pickup_date:this.ygen.getDateinformat(t,"YYYY-MM-DD"),pickup_location:this.ygen.getSettings().warehouse,expected_package_count:1};const n={headers:new M.d({"Content-Type":"application/json",Authorization:"replacetoken"})};let i="https://staging-express.delhivery.com/fm/request/new/";this.ygen.getSettings().testdelivery?n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokentest):(n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokenlive),i="https://track.delhivery.com/\u200bfm/request/new/"),this.http.post(i,r,n).pipe(W(3),Object(x.a)(e=>Object(p.a)(e))).subscribe(t=>{let r={deliverytrack:t,manualpickup:!1};this.orderlist.getListRefer().update(e,r),this.alertme.openSnackBar("Pick up request created [Auto]","Done")},t=>{this.orderlist.getListRefer().update(e,{manualpickup:!0}),this.alertme.openSnackBar("Pick up request created [Manual]","Ok")})}}}return e.\u0275fac=function(t){return new(t||e)(I.Qb(N.a),I.Qb(M.b),I.Qb(O.c),I.Qb(f.a),I.Qb(h.a),I.Qb(y.a),I.Qb(u.a),I.Qb(o.j),I.Qb(b.a),I.Qb(v.a),I.Qb(c.a),I.Qb(l.a),I.Qb(V.a),I.Qb(d.a),I.Qb(w.b))},e.\u0275cmp=I.Kb({type:e,selectors:[["app-checkoutdetail"]],decls:9,vars:3,consts:[[3,"color"],["slot","start"],["src","https://guarded-sea-64699.herokuapp.com/favicon.png",2,"display","none"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],["text-center","","class","msgTextSection",4,"ngIf"],["text-center","","class","cartTextSection",4,"ngIf"],[3,"linear"],["stepper",""],["matStepLabel",""],["class","example-radio-group","aria-label","Select an option",3,"formControl",4,"ngIf"],["color","warn","mat-button","","matStepperNext",""],["aria-label","Select an option",1,"example-radio-group",3,"formControl"],["class","example-radio-button","value","COD",4,"ngIf"],["class","example-radio-button","value","PNO",4,"ngIf"],[1,"example-form"],[1,"example-full-width"],["matInput","","placeholder","Ex. Thanks...",3,"formControl"],["text-center","",1,"msgTextSection"],[2,"right","20px","position","absolute"],[2,"display","inline-flex"],["style","padding-right: 5px;",4,"ngIf"],["mat-mini-fab","","style","background: lightgreen;",3,"click",4,"ngIf"],[2,"padding-right","5px"],[3,"mobile"],["mat-mini-fab","",2,"background","lightgreen",3,"click"],["name","logo-whatsapp",2,"font-size","x-large"],["text-center","",1,"cartTextSection"],["name","cart","role","img","aria-label","cart",1,"cartIcon"],["color","success","routerLink","/products"],["class","example-radio-button","value","HD",4,"ngIf"],["class","example-radio-button","value","SP",4,"ngIf"],["value","HD",1,"example-radio-button"],["value","SP",1,"example-radio-button"],["value","COD",1,"example-radio-button"],["value","PNO",1,"example-radio-button"],[1,"example-form",3,"formGroup"],["cellspacing","0",1,"example-full-width"],["yogagainv2InputUpper","","matInput","","formControlName","userName"],[3,"cssClass","preferredCountries","enablePlaceholder","placeholder","enableSearch","formControl","required"],["yogagainv2InputUpper","","matInput","","formControlName","unitName"],["matInput","","placeholder","Ex. CIVIL LINES","formControlName","address"],["matInput","","placeholder","Ex. GONDIA","formControlName","city"],["matInput","","placeholder","Ex. MAHARASHTRA","formControlName","state"],["type","number","matInput","","maxlength","5","placeholder","Ex. 94105","formControlName","zip"],["postalCode",""],["align","end"],[2,"display","none"],["matInput","","type","text","formControlName","country","required","true"],["whatcountry",""],[3,"country","onCountrySelected"],[3,"color",4,"ngIf"],[1,"delivery"],[1,"footerCartSection"],["color","danger",3,"disabled","click",4,"ngIf"],["color","danger",4,"ngIf"],["color","danger",3,"disabled","click"],["color","danger"]],template:function(e,t){1&e&&(I.Wb(0,"ion-header"),I.Wb(1,"ion-toolbar",0),I.Wb(2,"ion-buttons",1),I.Rb(3,"ion-back-button"),I.Vb(),I.Wb(4,"ion-title"),I.Mc(5,"Payment/Delivery"),I.Vb(),I.Vb(),I.Vb(),I.Rb(6,"img",2),I.Kc(7,pe,41,17,"ion-content",3),I.Kc(8,ve,3,2,"ion-footer",4)),2&e&&(I.Db(1),I.rc("color","warning"),I.Db(6),I.rc("ngIf",t.payer),I.Db(1),I.rc("ngIf",t.payer&&t.ycat.getcartcount()>0))},directives:[a.y,a.fb,a.j,a.f,a.g,a.db,n.m,a.s,j.e,j.a,j.b,T.a,j.d,q.b,i.o,i.e,i.w,i.p,i.q,P.c,P.g,F.b,i.b,K.a,a.z,a.i,a.qb,o.l,q.a,i.h,L.a,i.f,A.a,i.u,P.f,i.s,i.j,R.a,P.b,a.w,a.ab],pipes:[E.c],styles:[".footerCartSection[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.delivery[_ngcontent-%COMP%], .footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-form-field-infix[_ngcontent-%COMP%]{width:150px;max-width:150px}  .mat-form-field-infix{width:150px!important}.example-form[_ngcontent-%COMP%]{padding:20px}.example-full-width[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{padding-right:8px}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.msgTextSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px}"]}),e})();var De=r("hVaU"),We=r("IZvt"),ke=r("4pxM");const Se=[{path:"",component:Ve}];let xe=(()=>{class e{}return e.\u0275mod=I.Ob({type:e}),e.\u0275inj=I.Nb({factory:function(t){return new(t||e)},imports:[[n.c,i.i,a.gb,De.a,We.a,ke.a,i.t,o.n.forChild(Se)]]}),e})()}}]);