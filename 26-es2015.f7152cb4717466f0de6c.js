(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{upr6:function(e,t,r){"use strict";r.r(t),r.d(t,"CheckoutdetailPageModule",(function(){return se}));var n=r("ofXK"),a=r("3Pt+"),i=r("tyNb"),o=r("TEn/"),s=r("mrSG"),c=r("2Vo4"),l=r("z6cu"),b=r("IzEk"),d=r("un/a"),g=r("JIr8"),p=r("tk/3"),y=r("OJQs"),u=r("fXoL"),m=r("gren"),h=r("0IaG"),f=r("xHqg"),v=r("bTqV"),D=r("QibW"),V=r("kmnG"),W=r("qFsG"),S=r("B9HH"),k=r("6xI8"),x=r("sYmb");const M=["paypalcontainer"];function I(e,t){if(1&e&&(u.Wb(0,"div",24),u.Rb(1,"app-callphone",25),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.rc("mobile",e.ygen.getSettings().oncallsupport)}}function N(e,t){if(1&e){const e=u.Xb();u.Wb(0,"button",26),u.ec("click",(function(){u.Cc(e);const t=u.ic(3);return t.ygen.inviteviawhatsapp(t.ygen.getSettings().oncallwhatsappsupport,"Hi")})),u.Rb(1,"ion-icon",27),u.Vb()}}function C(e,t){if(1&e&&(u.Wb(0,"div",19),u.Wb(1,"h3"),u.Mc(2),u.jc(3,"translate"),u.Vb(),u.Wb(4,"p"),u.Mc(5),u.Vb(),u.Wb(6,"div",20),u.Wb(7,"div",21),u.Kc(8,I,2,1,"div",22),u.Kc(9,N,2,0,"button",23),u.Vb(),u.Vb(),u.Vb()),2&e){const e=u.ic(2);u.Db(2),u.Nc(u.kc(3,4,"Store's Instructions")),u.Db(3),u.Nc(e.ygen.getSettings().checkoutordermsg),u.Db(3),u.rc("ngIf",e.ygen.getSettings().oncallsupport&&(""+e.ygen.getSettings().oncallsupport).length>1),u.Db(1),u.rc("ngIf",e.ygen.getSettings().oncallwhatsappsupport&&(""+e.ygen.getSettings().oncallwhatsappsupport).length>1)}}function w(e,t){if(1&e&&(u.Wb(0,"div",28),u.Rb(1,"ion-icon",29),u.Wb(2,"h3"),u.Mc(3),u.jc(4,"translate"),u.Vb(),u.Wb(5,"p"),u.Mc(6),u.Vb(),u.Rb(7,"app-callphone",25),u.Wb(8,"ion-button",30),u.Mc(9),u.jc(10,"translate"),u.Vb(),u.Vb()),2&e){const e=u.ic(2);u.Db(3),u.Nc(u.kc(4,4,"No more Orders or Shop Subscription Expired")),u.Db(3),u.Nc(e.ygen.getSettings().stopordersmessage),u.Db(1),u.rc("mobile",e.ygen.getSettings().oncallsupport),u.Db(2),u.Oc("",u.kc(10,6,"Come back again")," ")}}function O(e,t){1&e&&(u.Mc(0),u.jc(1,"translate")),2&e&&u.Nc(u.kc(1,1,"Pick your Delivery option"))}function j(e,t){1&e&&(u.Wb(0,"div"),u.Wb(1,"h1"),u.Mc(2),u.jc(3,"translate"),u.Vb(),u.Vb()),2&e&&(u.Db(2),u.Nc(u.kc(3,1,"No Delivery Options Setup by Store; You can not proceed further")))}function P(e,t){1&e&&(u.Wb(0,"mat-radio-button",33),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Oc(" ",u.kc(2,1,"Home Delivery"),""))}function T(e,t){1&e&&(u.Wb(0,"mat-radio-button",34),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Oc(" ",u.kc(2,1,"Store Pickup"),""))}function F(e,t){if(1&e&&(u.Wb(0,"mat-radio-group",13),u.Kc(1,P,3,3,"mat-radio-button",31),u.Kc(2,T,3,3,"mat-radio-button",32),u.Vb()),2&e){const e=u.ic(2);u.rc("formControl",e.deliveryType),u.Db(1),u.rc("ngIf",e.ygen.getSettings().onlyhomepickup),u.Db(1),u.rc("ngIf",e.ygen.getSettings().onlystorepickup)}}function q(e,t){1&e&&(u.Mc(0),u.jc(1,"translate")),2&e&&u.Nc(u.kc(1,1,"Pick your Payment option"))}function K(e,t){1&e&&(u.Wb(0,"mat-radio-button",35),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Oc(" ",u.kc(2,1,"Cash on Delivery"),""))}function L(e,t){1&e&&(u.Wb(0,"mat-radio-button",36),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Oc(" ",u.kc(2,1,"Pay Now")," "))}function A(e,t){1&e&&(u.Mc(0),u.jc(1,"translate")),2&e&&u.Nc(u.kc(1,1,"Address Details"))}function E(e,t){1&e&&(u.Wb(0,"legend"),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Nc(u.kc(2,1,"Your Details")))}function z(e,t){1&e&&(u.Wb(0,"legend"),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Nc(u.kc(2,1,"Delivery Address")))}function R(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.userName,"Name"),"")}}function Q(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.mobile,"mobile"),"")}}function H(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.unitName,"Building Name"),"")}}function _(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.address,"Address"),"")}}function B(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.city,"City"),"")}}function U(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.state,"State"),"")}}function Y(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.zip,"Postal Code"),"")}}function G(e,t){if(1&e&&(u.Wb(0,"mat-error"),u.Mc(1),u.Vb()),2&e){const e=u.ic(3);u.Db(1),u.Oc(" ",e.getErrorMessage(e.addressForm.controls.country,"Country"),"")}}const $=function(){return["in"]};function X(e,t){if(1&e){const e=u.Xb();u.Wb(0,"div"),u.Wb(1,"form",37),u.Wb(2,"fieldset"),u.Kc(3,E,3,3,"legend",4),u.Kc(4,z,3,3,"legend",4),u.Wb(5,"table",38),u.Wb(6,"tr"),u.Wb(7,"td"),u.Wb(8,"mat-form-field",17),u.Wb(9,"mat-label"),u.Mc(10),u.jc(11,"translate"),u.Vb(),u.Rb(12,"input",39),u.Kc(13,R,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(14,"tr"),u.Wb(15,"td"),u.Wb(16,"mat-form-field",17),u.Rb(17,"ngx-mat-intl-tel-input",40),u.jc(18,"translate"),u.Wb(19,"mat-hint"),u.Mc(20),u.jc(21,"translate"),u.Vb(),u.Kc(22,Q,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(23,"tr"),u.Wb(24,"td"),u.Wb(25,"mat-form-field",17),u.Wb(26,"mat-label"),u.Mc(27),u.jc(28,"translate"),u.Vb(),u.Rb(29,"input",41),u.Kc(30,H,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(31,"p"),u.Wb(32,"mat-form-field",17),u.Wb(33,"mat-label"),u.Mc(34),u.jc(35,"translate"),u.Vb(),u.Wb(36,"textarea",42),u.Mc(37,"\n                  "),u.Vb(),u.Kc(38,_,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Wb(39,"table",38),u.Wb(40,"tr"),u.Wb(41,"td"),u.Wb(42,"mat-form-field",17),u.Wb(43,"mat-label"),u.Mc(44),u.jc(45,"translate"),u.Vb(),u.Rb(46,"input",43),u.Kc(47,B,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(48,"tr"),u.Wb(49,"td"),u.Wb(50,"mat-form-field",17),u.Wb(51,"mat-label"),u.Mc(52),u.jc(53,"translate"),u.Vb(),u.Rb(54,"input",44),u.Kc(55,U,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(56,"tr"),u.Wb(57,"td"),u.Wb(58,"mat-form-field",17),u.Wb(59,"mat-label"),u.Mc(60),u.jc(61,"translate"),u.Vb(),u.Rb(62,"input",45,46),u.Wb(64,"mat-hint",47),u.Mc(65),u.Vb(),u.Kc(66,Y,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(67,"tr"),u.Wb(68,"td"),u.Wb(69,"mat-form-field",48),u.Rb(70,"input",49,50),u.Vb(),u.Wb(72,"mat-select-country",51),u.ec("onCountrySelected",(function(t){u.Cc(e);const r=u.ic(2);return r.onCountrySelected(t,r.addressForm.controls.country)})),u.Vb(),u.Kc(73,G,2,1,"mat-error",4),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&e){const e=u.zc(63),t=u.zc(71),r=u.ic(2);u.Db(1),u.rc("formGroup",r.addressForm),u.Db(2),u.rc("ngIf",r.isrequiredAddressForm()),u.Db(1),u.rc("ngIf",!r.isrequiredAddressForm()),u.Db(6),u.Nc(u.kc(11,27,"Name")),u.Db(3),u.rc("ngIf",r.addressForm.controls.userName.invalid),u.Db(4),u.sc("placeholder",u.kc(18,29,"mobile")),u.rc("cssClass","custom")("preferredCountries",u.uc(43,$))("enablePlaceholder",!0)("enableSearch",!0)("formControl",r.addressForm.controls.mobile)("required",!0),u.Db(3),u.Nc(u.kc(21,31,"Your Mobile..")),u.Db(2),u.rc("ngIf",r.addressForm.controls.mobile.invalid),u.Db(5),u.Nc(u.kc(28,33,"Building Name")),u.Db(3),u.rc("ngIf",r.addressForm.controls.unitName.invalid),u.Db(4),u.Nc(u.kc(35,35,"Address")),u.Db(4),u.rc("ngIf",r.addressForm.controls.address.invalid),u.Db(6),u.Nc(u.kc(45,37,"City")),u.Db(3),u.rc("ngIf",r.addressForm.controls.city.invalid),u.Db(5),u.Nc(u.kc(53,39,"State")),u.Db(3),u.rc("ngIf",r.addressForm.controls.state.invalid),u.Db(5),u.Nc(u.kc(61,41,"Postal Code")),u.Db(5),u.Oc("",e.value.length,"/5"),u.Db(1),u.rc("ngIf",r.addressForm.controls.zip.invalid),u.Db(6),u.rc("country",t.value),u.Db(1),u.rc("ngIf",r.addressForm.controls.country.invalid)}}function J(e,t){1&e&&(u.Wb(0,"div",28),u.Rb(1,"ion-icon",29),u.Wb(2,"h3"),u.Mc(3),u.jc(4,"translate"),u.Vb(),u.Wb(5,"p"),u.Mc(6),u.jc(7,"translate"),u.Vb(),u.Wb(8,"ion-button",30),u.Mc(9),u.jc(10,"translate"),u.Vb(),u.Vb()),2&e&&(u.Db(3),u.Nc(u.kc(4,3,"Your Cart is Empty")),u.Db(3),u.Nc(u.kc(7,5,"Lets get you started")),u.Db(3),u.Oc("",u.kc(10,7,"Start shopping")," "))}function Z(e,t){if(1&e&&(u.Wb(0,"ion-content",5),u.Kc(1,C,10,6,"div",6),u.Kc(2,w,11,8,"div",7),u.Wb(3,"mat-vertical-stepper",8,9),u.Wb(5,"mat-step"),u.Kc(6,O,2,3,"ng-template",10),u.Wb(7,"div"),u.Wb(8,"div"),u.Wb(9,"div"),u.Kc(10,j,4,3,"div",4),u.Kc(11,F,3,3,"mat-radio-group",11),u.Vb(),u.Vb(),u.Vb(),u.Wb(12,"div"),u.Wb(13,"button",12),u.Mc(14),u.jc(15,"translate"),u.Vb(),u.Vb(),u.Vb(),u.Wb(16,"mat-step"),u.Kc(17,q,2,3,"ng-template",10),u.Wb(18,"div"),u.Wb(19,"div"),u.Wb(20,"div"),u.Wb(21,"mat-radio-group",13),u.Kc(22,K,3,3,"mat-radio-button",14),u.Kc(23,L,3,3,"mat-radio-button",15),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(24,"div"),u.Wb(25,"button",12),u.Mc(26),u.jc(27,"translate"),u.Vb(),u.Vb(),u.Vb(),u.Wb(28,"mat-step"),u.Kc(29,A,2,3,"ng-template",10),u.Wb(30,"div"),u.Wb(31,"form",16),u.Wb(32,"fieldset"),u.Wb(33,"legend"),u.Mc(34),u.jc(35,"translate"),u.Vb(),u.Wb(36,"mat-form-field",17),u.Wb(37,"mat-label"),u.Mc(38),u.jc(39,"translate"),u.Vb(),u.Rb(40,"textarea",18),u.Vb(),u.Vb(),u.Vb(),u.Kc(41,X,74,44,"div",4),u.Vb(),u.Vb(),u.Vb(),u.Kc(42,J,11,9,"div",7),u.Vb()),2&e){const e=u.ic();u.Db(1),u.rc("ngIf",e.ygen.getSettings().checkoutordermsg&&e.ygen.getSettings().checkoutordermsg.length>0),u.Db(1),u.rc("ngIf",e.ygen.getSettings().stoporders||!e.ygen.isActiveSubscription()),u.Db(1),u.rc("linear",!1),u.Db(7),u.rc("ngIf",!(e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup)),u.Db(1),u.rc("ngIf",e.ygen.getSettings().onlystorepickup||e.ygen.getSettings().onlyhomepickup),u.Db(3),u.Nc(u.kc(15,15,"Next")),u.Db(7),u.rc("formControl",e.paymentType),u.Db(1),u.rc("ngIf",e.ygen.getSettings().offercod),u.Db(1),u.rc("ngIf",e.ygen.getSettings().onlinepay),u.Db(3),u.Nc(u.kc(27,17,"Next")),u.Db(8),u.Nc(u.kc(35,19,"Delivery Note-Instruction")),u.Db(4),u.Nc(u.kc(39,21,"Leave a note-instruction about order")),u.Db(2),u.rc("formControl",e.deliveryNote),u.Db(1),u.rc("ngIf","HD"==e.deliveryType.value||e.isrequiredAddressForm()),u.Db(1),u.rc("ngIf",0==e.ycat.getcartcount())}}function ee(e,t){if(1&e&&(u.Wb(0,"ion-toolbar"),u.Wb(1,"div",54),u.Wb(2,"ion-text"),u.Wb(3,"h3"),u.Mc(4),u.jc(5,"translate"),u.Vb(),u.Vb(),u.Wb(6,"ion-text"),u.Wb(7,"h3"),u.Mc(8),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){const e=u.ic(2);u.Db(4),u.Nc(u.kc(5,3,"Delivery Charges")),u.Db(4),u.Pc(" ",e.ygen.getcurrencysymbol()," ",e.ygen.getSettings().deliverycharges," ")}}function te(e,t){if(1&e){const e=u.Xb();u.Wb(0,"ion-button",58),u.ec("click",(function(){u.Cc(e);const t=u.ic(3);return t.payoptions(t.ycat.getcart())})),u.Mc(1),u.jc(2,"translate"),u.Vb()}if(2&e){const e=u.ic(3);u.rc("disabled",e.isReady()),u.Db(1),u.Oc(" ",u.kc(2,2,"Complete Order"),"")}}function re(e,t){1&e&&(u.Wb(0,"ion-button",59),u.Mc(1),u.jc(2,"translate"),u.Vb()),2&e&&(u.Db(1),u.Oc(" ",u.kc(2,1,"No More Orders"),""))}function ne(e,t){if(1&e&&(u.Wb(0,"ion-toolbar",0),u.Wb(1,"div",55),u.Wb(2,"ion-text"),u.Wb(3,"h3"),u.Mc(4),u.jc(5,"translate"),u.Vb(),u.Vb(),u.Kc(6,te,3,4,"ion-button",56),u.Kc(7,re,3,3,"ion-button",57),u.Wb(8,"ion-text"),u.Wb(9,"h3"),u.Mc(10),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){const e=u.ic(2);u.rc("color","warning"),u.Db(4),u.Nc(u.kc(5,6,"Total")),u.Db(2),u.rc("ngIf",!e.ygen.getSettings().stoporders&&e.ygen.isActiveSubscription()&&!e.ispaypal),u.Db(1),u.rc("ngIf",e.ygen.getSettings().stoporders&&!e.ygen.isActiveSubscription()),u.Db(3),u.Pc(" ",e.ygen.getcurrencysymbol()," ",e.getTotal()," ")}}function ae(e,t){1&e&&u.Rb(0,"div",60,61)}function ie(e,t){if(1&e&&(u.Wb(0,"ion-footer"),u.Kc(1,ee,9,5,"ion-toolbar",4),u.Kc(2,ne,11,8,"ion-toolbar",52),u.Kc(3,ae,2,0,"div",53),u.Vb()),2&e){const e=u.ic();u.Db(1),u.rc("ngIf","HD"==e.deliveryType.value&&!e.ygen.getSettings().freedelivery&&e.ygen.getSettings().freedeliveryoveramount&&e.ygen.getSettings().freedeliveryamount>e.ycat.getTotal()||!e.ygen.getSettings().freedeliveryoveramount&&!e.ygen.getSettings().freedelivery),u.Db(1),u.rc("ngIf",e.ycat.getcartcount()>0),u.Db(1),u.rc("ngIf",e.ycat.getcartcount()>0&&e.ispaypal)}}const oe=[{path:"",component:(()=>{class e{constructor(e,t,r,n,a,i,o,s,l,b,d,g,p,u,m,h,f){this.centerdb=e,this.http=t,this.ngxUiLoaderService=r,this.ynotification=n,this.yovalidation=a,this.yauth=i,this.ydata=o,this.router=s,this.ygen=l,this.events=b,this.ycat=d,this.alertme=g,this.spaypal=p,this.ystripe=u,this.ypaytm=m,this.ypay=h,this.dialog=f,this.serverpath=y.s.herobackendserver,this.ispaypal=!1,this.gotappsettings=new c.a(!1),this.ispaypal=this.ygen.getSettings().paypal}buildForm(e){let t=e.country?e.country:"India",r=e.mobile?e.mobile:this.yauth.myprofile.mobile;this.addressForm=new a.h({userName:new a.e(e.userName,[a.y.required,a.y.minLength(2),a.y.maxLength(30)]),mobile:new a.e(r,[a.y.required,a.y.minLength(2),a.y.maxLength(30)]),unitName:new a.e(e.unitName,[a.y.required,a.y.minLength(2),a.y.maxLength(30)]),address:new a.e(e.address,[a.y.required,a.y.minLength(2),a.y.maxLength(100)]),city:new a.e(e.city,[a.y.required,a.y.minLength(2),a.y.maxLength(30)]),state:new a.e(e.state,[a.y.required,a.y.minLength(2),a.y.maxLength(30)]),zip:new a.e(e.zip,{validators:[a.y.required,a.y.minLength(2),a.y.maxLength(30)],asyncValidators:[Object(y.gb)(this.ygen)],updateOn:"blur"}),country:new a.e(t,{validators:[a.y.required,a.y.minLength(2),a.y.maxLength(30)]})});let n="HD";this.ygen.getSettings().onlystorepickup&&(n="SP"),this.ygen.getSettings().onlystorepickup||this.ygen.getSettings().onlyhomepickup||(n=""),this.deliveryType=new a.e(n,[a.y.required,a.y.max(2)]),setTimeout(()=>{this.paymentType.setValue(n)},100);let i="COD";this.ygen.getSettings().onlinepay&&(i="PNO"),this.ygen.getSettings().onlinepay||this.ygen.getSettings().offercod||(i=""),this.paymentType=new a.e(i,[a.y.required,a.y.max(3)]),setTimeout(()=>{this.paymentType.setValue(i)},100),this.deliveryNote=new a.e("Thanks",[a.y.required,a.y.max(100)]),this.addressForm.controls.mobile.setValue(r),this.addressForm.controls.country.setValue(t),this.ispaypal&&setTimeout(()=>{this.payoptions(this.ycat.getcart())},100)}isrequiredAddressForm(){return!(!this.payer||this.payer.userName&&this.payer.mobile)}ngOnInit(){this.ydata.retrivedata(y.P.getpath()+"/settings",null).subscribe(e=>{this.yauth.setappSettings(e),this.gotappsettings.next(!0)}),this.ynotification.getStoreAdmins(),this.ygen.getUid()?this.getUserProfile().then(e=>{this.ngxUiLoaderService.stop(),this.payer=e,this.payer?this.buildForm(this.payer):(console.error("blank form"),this.buildForm({}))}).finally(()=>{this.ngxUiLoaderService.stop()}):(this.yauth.setlanding("/checkoutdetail"),this.router.navigate(["/login"],{}))}getUserProfile(){return Object(s.a)(this,void 0,void 0,(function*(){this.ngxUiLoaderService.start();const e=yield this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).valueChanges().pipe(Object(b.a)(1)).toPromise();return yield e}))}addtocart(e,t,r){r&&(t.orderqty=0);let n=t.orderqty?t.orderqty+e:1;n>t.maxqty?this.alertme.openSnackBar(`Maximum quantiy you can order is ${t.maxqty}`,"Ok"):(Object.assign(t,{orderqty:n}),this.ycat.iscartItem(t)?this.ycat.updatequantity(t):1==n&&(this.alertme.openSnackBar(`Your shopping cart updated with ${t.orderqty} quantity`,"Ok"),this.ycat.addtocart(t))),0==t.orderqty&&this.ycat.delete(t)}pay(e){let t=""+ +new Date,r=this.ygen.randomletter()+this.ygen.randomletter()+~~(1e3*Math.random())+t.substring(t.length-4);e.forEach(e=>{e.$key?e.originalkey=e.$key:console.warn("no Key.."),delete e.$key});let n={trancurrency:this.ygen.getTranCurrency().toLowerCase(),sendorderid:r,isorder:!0,payload:e,amount:this.getTotal(),orderByName:this.addressForm.controls.userName.value,orderByPhone:this.addressForm.controls.mobile.value,deliveryAddress:this.ygen.getAddress(this.addressForm.value),zipcode:this.addressForm.value.zip,city:this.addressForm.value.city,storeAddress:this.ygen.getAddress(y.db.selectedtenant),storePhone:this.ygen.getCommunityContactPhone(),storeId:this.ygen.getStoreKey(),wheredelivery:this.deliveryType.value,deliverynote:this.deliveryNote.value,storename:this.ygen.communityName(),orderedBy:this.payer.uid,islivetran:!this.ygen.getSettings().testonlinepay,gateway:"?"};"INVALID"!=this.addressForm.status&&this.ydata.getDatabase().object("/profiles/"+this.yauth.getCurrentUserId()).update(this.addressForm.value),this.ygen.getSettings().usepaytm?n.gateway="paytm":this.ygen.getSettings().userazorpay?n.gateway="razorpay":this.ygen.getSettings().usestripe?n.gateway="stripe":this.ygen.getSettings().paypal&&(n.gateway="paypal"),this.events.subscribe("order:success["+r+"]",e=>{this.yauth.setlanding(null),this.events.unsubscribe("order:success["+r+"]"),this.ygen.findDistanceForOrder(n.deliveryAddress,!0);let t=this.ydata.getDatabase().createPushId();e.key=t,this.ydata.getDatabase().list(y.P.getpath()+"/shop/orders").set(t,e),this.ynotification.sendNotificationToTakeUser(this.payer.uid,{message:"Order Successfully placed with, OrderID=["+r+"]",path:"order?orderid="+t},"Order Success",!0,!0,!0),this.alertme.successdata("Order Successfully placed with, OrderID=["+r+"]").then(e=>{console.log("done",e)}),"razorpay"==n.gateway&&"COD"!=this.paymentType.value&&this.capturepayment(n),this.router.navigate(["/order"],{queryParams:{orderid:t,orderkey:r,orderplaced:!0}}),this.ycat.emptycart(),this.ycat.updateProductQuantity()}),"COD"==this.paymentType.value?(n.paymentmethod="COD",Object.assign(n,{orderedBy:this.payer.uid,odt:+new Date,ostatus:"NEW"}),this.events.publish("order:success["+n.sendorderid+"]",n)):this.ygen.getSettings().usepaytm?(n.gateway="paytm",this.ypaytm.pay(n)):this.ygen.getSettings().userazorpay?(n.gateway="razorpay",this.ypay.pay(n)):this.ygen.getSettings().paypal?(n.gateway="paypal",this.spaypal.setPayElement(this.paypalcontainer),this.spaypal.pay(n)):this.ygen.getSettings().usestripe?(n.gateway="stripe",this.gotappsettings.subscribe(e=>{e&&this.ystripe.pay(n)})):this.alertme.errordata("No Payment Gateway Options enabled")}onCountrySelected(e,t){t.setValue(e.name)}payoptions(e){this.pay(e)}getErrorMessage(e,t){let r="",n=this.getMeErrors({placeholder:t});return Object.keys(n).some(t=>{if(e.errors[t])return r=n[t],!0}),r}getMeErrors(e){return this.yovalidation.genericErrors(e)}getTotal(){let e=this.ycat.getTotal();return"HD"!=this.deliveryType.value||this.ygen.getSettings().freedelivery||(this.ygen.getSettings().freedeliveryoveramount&&this.ygen.getSettings().freedeliveryamount>this.ycat.getTotal()?e+=this.ygen.getSettings().deliverycharges:this.ygen.getSettings().freedeliveryoveramount||(e+=this.ygen.getSettings().deliverycharges)),e}isReady(){let e=!0;return"HD"==this.deliveryType.value?e=!this.addressForm.valid:"SP"==this.deliveryType.value&&(e=this.isrequiredAddressForm()&&!this.addressForm.valid),e}capturepayment(e){let t=e.key,r=this.yauth.getappSettings(),n=r.testonlinepay;r.testonlinepay||(n=!1);let a=`${y.s.herobackendserver}/rest/razor/capture?testmode=${n}&paymentid=${e.paymentResponse.payment_id}`,i={amount:100*e.amount,currency:"INR"};const o={headers:new p.d({"Content-Type":"application/json",Authorization:"yoyo"})};this.http.post(a,i,o).pipe(Object(d.a)(1)).subscribe(e=>{let r={paymentcaptured:!0,paymentcaptureddetail:e};console.log("capture payment",e),e.err||this.ydata.getDatabase().list(y.P.getpath()+"/shop/orders").update(t,r)},e=>{this.ydata.getDatabase().list(y.P.getpath()+"/shop/orders").update(t,{paymentcaptured:!1,paymentcaptureddetail:{error:"Did not go well at server"}})})}createpickup(e){if(this.ygen.getSettings().deliveryenabled){let t=+new Date,r={pickup_time:this.ygen.getTimeinformat(t,"HH:mm:ss"),pickup_date:this.ygen.getDateinformat(t,"YYYY-MM-DD"),pickup_location:this.ygen.getSettings().warehouse,expected_package_count:1};const n={headers:new p.d({"Content-Type":"application/json",Authorization:"replacetoken"})};let a="https://staging-express.delhivery.com/fm/request/new/";this.ygen.getSettings().testdelivery?n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokentest):(n.headers=n.headers.set("Authorization","Token "+this.ygen.getSettings().deliverytokenlive),a="https://track.delhivery.com/\u200bfm/request/new/"),this.http.post(a,r,n).pipe(Object(d.a)(3),Object(g.a)(e=>Object(l.a)(e))).subscribe(t=>{let r={deliverytrack:t,manualpickup:!1};this.orderlist.getListRefer().update(e,r),this.alertme.openSnackBar("Pick up request created [Auto]","Done")},t=>{this.orderlist.getListRefer().update(e,{manualpickup:!0}),this.alertme.openSnackBar("Pick up request created [Manual]","Ok")})}}onPopstate(){console.log("coming in"),this.ystripe.getHandler().close()}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(y.P),u.Qb(p.b),u.Qb(m.c),u.Qb(y.U),u.Qb(y.fb),u.Qb(y.M),u.Qb(y.Q),u.Qb(i.j),u.Qb(y.T),u.Qb(y.Y),u.Qb(y.O),u.Qb(y.a),u.Qb(y.ab),u.Qb(y.L),u.Qb(y.bb),u.Qb(y.Z),u.Qb(h.b))},e.\u0275cmp=u.Kb({type:e,selectors:[["app-checkoutdetail"]],viewQuery:function(e,t){var r;1&e&&u.Tc(M,!0),2&e&&u.yc(r=u.fc())&&(t.paypalcontainer=r.first)},hostBindings:function(e,t){1&e&&u.ec("popstate",(function(){return t.onPopstate()}),!1,u.Bc)},decls:9,vars:4,consts:[[3,"color"],["slot","start"],[2,"display","none",3,"src"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],[1,"ion-padding"],["text-center","","class","msgTextSection",4,"ngIf"],["text-center","","class","cartTextSection",4,"ngIf"],[3,"linear"],["stepper",""],["matStepLabel",""],["class","example-radio-group","aria-label","Select an option",3,"formControl",4,"ngIf"],["color","warn","mat-button","","matStepperNext",""],["aria-label","Select an option",1,"example-radio-group",3,"formControl"],["class","example-radio-button","value","COD",4,"ngIf"],["class","example-radio-button","value","PNO",4,"ngIf"],[1,"example-form"],[1,"example-full-width"],["matInput","","placeholder","Ex. Thanks...",3,"formControl"],["text-center","",1,"msgTextSection"],[2,"right","20px","position","absolute"],[2,"display","inline-flex"],["style","padding-right: 5px;",4,"ngIf"],["mat-mini-fab","","style","background: lightgreen;",3,"click",4,"ngIf"],[2,"padding-right","5px"],[3,"mobile"],["mat-mini-fab","",2,"background","lightgreen",3,"click"],["name","logo-whatsapp",2,"font-size","x-large"],["text-center","",1,"cartTextSection"],["name","cart","role","img","aria-label","cart",1,"cartIcon"],["color","success","routerLink","/products"],["class","example-radio-button","value","HD",4,"ngIf"],["class","example-radio-button","value","SP",4,"ngIf"],["value","HD",1,"example-radio-button"],["value","SP",1,"example-radio-button"],["value","COD",1,"example-radio-button"],["value","PNO",1,"example-radio-button"],[1,"example-form",3,"formGroup"],["cellspacing","0",1,"example-full-width"],["yogagainv2InputUpper","","matInput","","formControlName","userName"],[3,"cssClass","preferredCountries","enablePlaceholder","placeholder","enableSearch","formControl","required"],["yogagainv2InputUpper","","matInput","","formControlName","unitName"],["matInput","","placeholder","Ex. CIVIL LINES","formControlName","address"],["matInput","","placeholder","Ex. GONDIA","formControlName","city"],["matInput","","placeholder","Ex. MAHARASHTRA","formControlName","state"],["type","number","matInput","","maxlength","5","placeholder","Ex. 94105","formControlName","zip"],["postalCode",""],["align","end"],[2,"display","none"],["matInput","","type","text","formControlName","country","required","true"],["whatcountry",""],[3,"country","onCountrySelected"],[3,"color",4,"ngIf"],["style","margin: 0 auto;display: flex;justify-content: center;padding-top: 10px;",4,"ngIf"],[1,"delivery"],[1,"footerCartSection"],["color","danger",3,"disabled","click",4,"ngIf"],["color","danger",4,"ngIf"],["color","danger",3,"disabled","click"],["color","danger"],[2,"margin","0 auto","display","flex","justify-content","center","padding-top","10px"],["paypalcontainer",""]],template:function(e,t){1&e&&(u.Wb(0,"ion-header"),u.Wb(1,"ion-toolbar",0),u.Wb(2,"ion-buttons",1),u.Rb(3,"ion-back-button"),u.Vb(),u.Wb(4,"ion-title"),u.Mc(5,"Payment/Delivery"),u.Vb(),u.Vb(),u.Vb(),u.Rb(6,"img",2),u.Kc(7,Z,43,23,"ion-content",3),u.Kc(8,ie,4,3,"ion-footer",4)),2&e&&(u.Db(1),u.rc("color","warning"),u.Db(5),u.tc("src","",t.serverpath,"/favicon.png",u.Ec),u.Db(1),u.rc("ngIf",t.payer),u.Db(1),u.rc("ngIf",t.payer&&t.ycat.getcartcount()>0))},directives:[o.y,o.hb,o.j,o.f,o.g,o.fb,n.m,o.s,f.e,f.a,f.b,v.a,f.d,D.b,a.p,a.f,a.A,a.q,a.r,V.c,V.g,W.b,a.c,y.j,o.z,o.i,o.sb,i.l,D.a,a.i,y.u,a.g,S.a,a.w,V.f,a.u,a.k,k.a,V.b,o.w,o.cb],pipes:[x.c],styles:[".footerCartSection[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.delivery[_ngcontent-%COMP%], .footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-form-field-infix[_ngcontent-%COMP%]{width:150px;max-width:150px}  .mat-form-field-infix{width:150px!important}.example-full-width[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{padding-right:8px}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.msgTextSection[_ngcontent-%COMP%]{display:flex;flex-direction:column}  .mat-vertical-content{padding:0!important}.example-form[_ngcontent-%COMP%]{padding:0}legend[_ngcontent-%COMP%]{font-size:small;line-height:inherit;color:#f44336}"]}),e})()}];let se=(()=>{class e{}return e.\u0275mod=u.Ob({type:e}),e.\u0275inj=u.Nb({factory:function(t){return new(t||e)},imports:[[n.c,a.j,o.ib,y.H,y.o,y.b,a.v,i.n.forChild(oe)]]}),e})()}}]);