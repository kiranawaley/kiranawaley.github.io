(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"8roW":function(t,e,n){"use strict";n.r(e),n.d(e,"CatalogwebPageModule",(function(){return P}));var i=n("ofXK"),o=n("3Pt+"),s=n("TEn/"),c=n("tyNb"),r=n("LRne"),a=n("q3Kh"),l=n("OJQs"),d=n("JIr8"),b=n("un/a"),h=n("fXoL"),u=n("gren"),p=n("tk/3"),g=n("1jcm"),f=n("hV0v"),m=n("sYmb");function y(t,e){1&t&&h.Rb(0,"ion-progress-bar",8)}function v(t,e){if(1&t){const t=h.Xb();h.Wb(0,"ion-item"),h.Wb(1,"mat-slide-toggle",9),h.ec("ngModelChange",(function(e){return h.Cc(t),h.ic().saveonlytoglobal=e})),h.Mc(2),h.jc(3,"translate"),h.Vb(),h.Vb()}if(2&t){const t=h.ic();h.Db(1),h.rc("ngModel",t.saveonlytoglobal),h.Db(1),h.Oc("",h.kc(3,2,"Save only to Global")," ")}}function w(t,e){1&t&&(h.Wb(0,"div"),h.Mc(1),h.jc(2,"translate"),h.Vb()),2&t&&(h.Db(1),h.Oc(" ",h.kc(2,1,"No Product Found")," "))}function k(t,e){if(1&t){const t=h.Xb();h.Wb(0,"app-productcard-grandbazar",13),h.ec("actionevent",(function(e){return h.Cc(t),h.ic(3).perform(e)})),h.Vb()}if(2&t){const t=e.$implicit,n=h.ic(3);h.rc("product",t)("webcatalogupload",!0)("productlist",n.crudList)("onpage","catalogweb")}}function j(t,e){if(1&t&&(h.Wb(0,"div",11),h.Kc(1,w,3,3,"div",5),h.Kc(2,k,1,4,"app-productcard-grandbazar",12),h.Vb()),2&t){const t=e.ngIf,n=h.ic(2);h.Db(1),h.rc("ngIf",0==t.length),h.Db(1),h.rc("ngForOf",n.processlist(t,n.whatsize))}}function O(t,e){if(1&t&&(h.Wb(0,"div"),h.Kc(1,j,3,2,"div",10),h.jc(2,"searchproducts"),h.Vb()),2&t){const t=h.ic(),e=h.zc(9);h.Db(1),h.rc("ngIf",h.mc(2,1,t.productlist,t.searchstring,e.value))}}function D(t,e){if(1&t){const t=h.Xb();h.Wb(0,"ion-infinite-scroll",14),h.ec("ionInfinite",(function(e){return h.Cc(t),h.ic().loadData(e)})),h.Rb(1,"ion-infinite-scroll-content",15),h.jc(2,"translate"),h.Vb()}2&t&&(h.Db(1),h.sc("loadingText",h.kc(2,1,"Loading more data...")))}const I=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,s){this.ngxUiLoaderService=t,this.alertme=e,this.http=n,this.centerdb=i,this.ydata=o,this.ygen=s,this.addItemList=[],this.productlistcount=0,this.totalproducts=0,this.showscroll=!1,this.productlimit=50,this.saveonlytoglobal=!1,this.whatsize=50,this.queryText="",this.searchstring="{}"}ngOnInit(){this.centerdb.currenttenant.subscribe(t=>{t&&(this.crudList=new l.p(l.P.getpath()+"/shop/products",this.ydata.getDatabase(),!0,this.ygen.getUid()),this.crudList.getList().subscribe(t=>{this.productlimit=t.length}))}),this.ngxUiLoaderService.start(),this.centerdb.currenttenant.subscribe(t=>{this.crudList=new l.p(l.P.getpath()+"/shop/products",this.ydata.getDatabase(),!0,this.ygen.getUid())}),this.webcatalogs=this.http.get("https://bandhanmaratha.firebaseio.com/catalogmaster.json").pipe(Object(a.map)(t=>(this.productlistcount=Object.keys(t).length,this.showscroll=!0,Object.keys(t).map(e=>Object.assign({maxqty:10,key:e},t[e])))),Object(d.a)(t=>(this.alertme.errordata("Error Retriving the Web Catalog From Remote Server...Please refresh.."),this.ngxUiLoaderService.stop(),Object(r.a)([]))),Object(b.a)(2)),this.webcatalogs.subscribe(t=>{this.productlist=t,this.ngxUiLoaderService.stop()})}addtolist(t){this.addItemList.push(t)}processlist(t,e=50){return t.length<e&&(e=t.length),t.slice(0,e)}loadData(t){setTimeout(()=>{console.log("Done"),t.target.complete(),this.whatsize>=this.productlistcount?t.target.disabled=!0:(t.target.disabled=!1,this.whatsize=this.whatsize+50)},500)}trimObjValues(t){return Object.keys(t).reduce((e,n)=>(e[n]="string"==typeof t[n]?t[n].trim():t[n],e),{})}saveItem(t){let e=(t=this.trimObjValues(t)).key;delete t.key,this.saveonlytoglobal||(this.ygen.canAddProducts()?this.crudList.addtolist(t):this.alertme.openSnackBar(`Reach ${this.productlimit} maxlimit of Products will not be added`,"OK")),this.globalsave(t,e)}globalsave(t,e){e&&e.length>0&&this.ygen.isSuperAdmin()&&this.http.put("https://bandhanmaratha.firebaseio.com/catalogmaster/"+e+".json",t).subscribe(t=>{})}globaldelete(t,e){e&&e.length>0&&this.ygen.isSuperAdmin()&&this.http.delete("https://bandhanmaratha.firebaseio.com/catalogmaster/"+e+".json").subscribe(t=>{})}perform(t){switch(t.what){case"add":t.event.discount=this.getDiscount(t.event),this.saveItem(t.event),this.productlist=this.productlist.filter(e=>e.key!=t.event.key),this.alertme.openSnackBar("Product Added to Your Catalog","Ok");break;case"delete":this.productlist=this.productlist.filter(e=>e.key!=t.event.key),this.alertme.openSnackBar("Product deleted","Ok");break;case"deletex":this.productlist=this.productlist.filter(e=>e.key!=t.event.key),this.globaldelete(t.event,t.event.key),this.alertme.openSnackBar("Product deleted","Ok");break;case"copy":t.event.discount=this.getDiscount(t.event),this.productlist.push(t.event),this.alertme.openSnackBar("Product copied","Ok")}}getDiscount(t){let e=t.mrp?t.mrp:200;return(100*(e-(t.price?t.price:100))/e).toFixed(0)}getItems(t){console.log(t)}setSearchedProducts(t){this.totalproducts=t.length}}return t.\u0275fac=function(e){return new(e||t)(h.Qb(u.c),h.Qb(l.a),h.Qb(p.b),h.Qb(l.P),h.Qb(l.Q),h.Qb(l.T))},t.\u0275cmp=h.Kb({type:t,selectors:[["app-catalogweb"]],decls:20,vars:17,consts:[[3,"color"],["slot","start"],["debounce","100",3,"placeholder","ngModel","ionChange","ngModelChange"],["mySearchbar",""],["loading",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["type"," indeterminate","reversed","true"],[3,"ngModel","ngModelChange"],["class","productlist",4,"ngIf"],[1,"productlist"],[3,"product","webcatalogupload","productlist","onpage","actionevent",4,"ngFor","ngForOf"],[3,"product","webcatalogupload","productlist","onpage","actionevent"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles",3,"loadingText"]],template:function(t,e){if(1&t&&(h.Wb(0,"ion-header"),h.Wb(1,"ion-toolbar",0),h.Wb(2,"ion-buttons",1),h.Rb(3,"ion-back-button"),h.Vb(),h.Wb(4,"ion-title"),h.Mc(5),h.jc(6,"translate"),h.Vb(),h.Vb(),h.Wb(7,"ion-toolbar",0),h.Wb(8,"ion-searchbar",2,3),h.ec("ionChange",(function(t){return e.getItems(t)}))("ngModelChange",(function(t){return e.queryText=t})),h.jc(10,"translate"),h.Vb(),h.Vb(),h.Vb(),h.Wb(11,"ion-content"),h.Kc(12,y,1,0,"ng-template",null,4,h.Lc),h.Wb(14,"ion-item"),h.Mc(15),h.Vb(),h.Kc(16,v,4,4,"ion-item",5),h.Kc(17,O,3,5,"div",6),h.jc(18,"async"),h.Kc(19,D,3,3,"ion-infinite-scroll",7),h.Vb()),2&t){const t=h.zc(13);h.Db(1),h.rc("color","warning"),h.Db(4),h.Nc(h.kc(6,11,"Web Catalog")),h.Db(2),h.rc("color","warning"),h.Db(1),h.sc("placeholder",h.kc(10,13,"Search Products")),h.rc("ngModel",e.queryText),h.Db(7),h.Pc(' You are using "',e.ygen.getSubscriptionType(),'" subscription; You can add max ',e.ygen.maxproductsCanAdded()," products; "),h.Db(1),h.rc("ngIf",e.ygen.isSuperAdmin()),h.Db(1),h.rc("ngIf",h.kc(18,15,e.webcatalogs))("ngIfElse",t),h.Db(2),h.rc("ngIf",e.showscroll)}},directives:[s.y,s.hb,s.j,s.f,s.g,s.fb,s.S,s.ub,o.p,o.s,s.s,s.D,i.m,s.P,g.a,i.l,f.a,s.A,s.B],pipes:[m.c,i.b,l.F],styles:[".productCardSection[_ngcontent-%COMP%]{white-space:nowrap;height:auto;overflow-X:scroll;overflow-y:hidden}.mytopsaver[_ngcontent-%COMP%]{display:flex}.productlist[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center}"]}),t})()}];let S=(()=>{class t{}return t.\u0275mod=h.Ob({type:t}),t.\u0275inj=h.Nb({factory:function(e){return new(e||t)},imports:[[c.n.forChild(I)],c.n]}),t})();var x=n("uUdd");let P=(()=>{class t{}return t.\u0275mod=h.Ob({type:t}),t.\u0275inj=h.Nb({factory:function(e){return new(e||t)},imports:[[i.c,o.j,s.ib,l.H,l.o,l.b,x.a,S]]}),t})()}}]);