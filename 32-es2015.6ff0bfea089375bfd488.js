(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{kuxn:function(e,t,i){"use strict";i.r(t),i.d(t,"EnterdetailPageModule",(function(){return M}));var a=i("ofXK"),n=i("3Pt+"),o=i("tyNb"),r=i("TEn/"),s=i("YKLQ"),l=i("X/JO"),c=i("D+2S"),h=i("wd/R"),d=i("mLjM"),u=i("DzsY"),m=i("rIxz"),b=i("PWOX"),g=i("fXoL"),f=i("bTqV"),p=i("NFeN"),y=i("Wp6s"),v=i("iEmi"),w=i("sYmb");function k(e,t){1&e&&(g.Wb(0,"ion-item"),g.Wb(1,"b"),g.Mc(2,"No Resident Found"),g.Vb(),g.Vb())}function I(e,t){if(1&e&&(g.Wb(0,"ion-item"),g.Wb(1,"b"),g.Mc(2),g.Vb(),g.Vb()),2&e){const e=g.ic(2);g.Db(2),g.Oc("[",e.tempItems.length,"] Residents found")}}function V(e,t){if(1&e){const e=g.Xb();g.Wb(0,"ion-item",10),g.Wb(1,"ion-label"),g.Mc(2),g.Vb(),g.Wb(3,"ion-checkbox",11),g.ec("ngModelChange",(function(i){return g.Cc(e),t.$implicit.checked=i}))("ionChange",(function(){g.Cc(e);const i=t.$implicit;return g.ic(2).putInSendRequest(i)})),g.Vb(),g.Vb()}if(2&e){const e=t.$implicit;g.Db(2),g.Pc("",e.userName," | ",e.unitName,""),g.Db(1),g.rc("ngModel",e.checked)}}function C(e,t){if(1&e&&(g.Wb(0,"div"),g.Kc(1,k,3,0,"ion-item",5),g.Kc(2,I,3,1,"ion-item",5),g.Kc(3,V,4,3,"ion-item",9),g.Vb()),2&e){const e=g.ic();g.Db(1),g.rc("ngIf",0==e.tempItems.length),g.Db(1),g.rc("ngIf",e.tempItems.length>0),g.Db(1),g.rc("ngForOf",e.tempItems)}}function D(e,t){if(1&e){const e=g.Xb();g.Wb(0,"yogagainv2-dyanamic-page",12),g.ec("actionEvent",(function(t){return g.Cc(e),g.ic().send(t)}))("cancelEvent",(function(t){return g.Cc(e),g.ic().cancel(t)})),g.Vb()}if(2&e){const e=g.ic();g.rc("isreadonly",e.isreadonly)("captchaOn",!1)("captchaName","registercaptcha")("whatform",e.whatcontrolsmap)("whatformgroup",e.inwhatformgroup)("whichbuttons",e.mybuttons)}}let O=(()=>{class e{constructor(e,t,i,a,n,o){this.ygen=e,this.authService=t,this.router=i,this.ydataservice=a,this.boardservice=n,this.yobuilderservice=o,this.worker={},this.filterdetail={},this.prof=new Array,this.items=new Array,this.toSendItems=new Array,this.searchQuery="",this.tempItems=new Array,this.mybuttons=new Map,this.filterProf=new Array,this.isreadonly=!1,console.log(a.getData("update")),console.log("comingin",a.getData("comingin")),this.worker=a.getData("comingin"),this.boardservice.getProfiles().valueChanges().forEach(e=>{if(this.prof=e,this.items=e,this.worker.history){let e=Object.keys(this.worker.history).map(e=>this.worker.history[e]);e.length>=1&&(this.filterdetail.visitingto=e[e.length-1].visitingto,this.getItems({target:{value:e[e.length-1].visitingto}}),this.filterdetail.reason=e[e.length-1].reason,this.filterdetail.vehicalnum=e[e.length-1].vehicalnum,this.filterdetail.needParking=e[e.length-1].needParking)}}),this.workers=a.getData("update"),this.iscomingtanker=a.getData("tanker"),this.startObject()}ngOnInit(){}changeReadOnly(){this.isreadonly=!this.isreadonly,this.startObject()}getItems(e){this.toSendItems=new Array;let t=e.target.value;this.searchQuery=t,t&&""!=t.trim()&&(this.tempItems=this.items.filter("*all"==t?e=>!0:e=>e.unitName?e.userid.toLowerCase().indexOf(t.toLowerCase())>-1||e.userName.toLowerCase().indexOf(t.toLowerCase())>-1||e.unitName.toLowerCase().indexOf(t.toLowerCase())>-1:e.userid.toLowerCase().indexOf(t.toLowerCase())>-1||e.userName.toLowerCase().indexOf(t.toLowerCase())>-1))}emptyordefault(e,t){return e||t}getDomainObject(e=!1){let t=[],i=0;return h(new Date).format("YYYY-MM-DD"),t[i]=new d.b(i,"reason","",d.a.select),t[i].placeholder="Reason",t[i].value={selected:this.emptyordefault(this.filterdetail.reason,"Resident"),options:["Visit","Delivery","Guest","Personal Work","Resident","Pickup","Tanker","Other"]},t[i].required=!0,t[i].readonly=e,i++,t[i]=new d.b(i,"visitingto","",d.a.text),t[i].placeholder="Visiting to",t[i].value=this.emptyordefault(this.filterdetail.visitingto,""),t[i].required=!0,t[i].readonly=e,i++,t[i]=new d.b(i,"contactname","",d.a.text),t[i].value=this.emptyordefault(this.worker.name,""),t[i].placeholder="Contact Name",t[i].required=!0,t[i].readonly=e,i++,t[i]=new d.b(i,"contactphone","",d.a.phone),t[i].value=this.emptyordefault(this.worker.mobile,""),t[i].placeholder="Contact Phone/Mobile",t[i].required=!0,t[i].readonly=e,i++,t[i]=new d.b(i,"needParking",!1,d.a.slidetoggle),t[i].placeholder="Need Visitor parking",t[i].required=!1,t[i].readonly=e,i++,t[i]=new d.b(i,"vehicalnum","",d.a.text),t[i].placeholder="Vehical Number",t[i].value=this.emptyordefault(this.filterdetail.vehicalnum,""),t[i].required=!1,t[i].readonly=e,i++,t[i]=new d.b(i,"notes","coming in",d.a.textarea),t[i].placeholder="Notes",t[i].required=!0,t[i].readonly=e,i++,t[i]=new d.b(i,"image","https://res.cloudinary.com/ideasyogi/image/upload/v1589964651/default_qkhcdj.jpg",d.a.image),t[i].placeholder="Profile Picture",t[i].required=!1,t[i].showme=!1,i++,t[i]=new d.b(i,"visitingtoemail","",d.a.text),t[i].placeholder="visitingtoemail",t[i].value=this.emptyordefault(this.filterdetail.visitingtoemail,""),t[i].required=!1,t[i].showme=!1,t[i].readonly=e,i++,t[i]=new d.b(i,"visitingtonotificationid","",d.a.tkey),t[i].placeholder="visitingtonotificationid",t[i].value=this.emptyordefault(this.filterdetail.visitingtonotificationid,""),t[i].required=!1,t[i].showme=!1,t[i].readonly=e,i++,t[i]=new d.b(i,"visitingtokey","",d.a.text),t[i].placeholder="visitingtokey",t[i].value=this.emptyordefault(this.filterdetail.visitingtokey,""),t[i].required=!1,t[i].showme=!1,t[i].readonly=e,i++,t[i]=new d.b(i,"visitingtomob","",d.a.text),t[i].placeholder="visitingtomob",t[i].value=this.emptyordefault(this.filterdetail.visitingtomob,""),t[i].required=!1,t[i].showme=!1,t[i].readonly=e,t.forEach(t=>{t.readonly=e}),t}startObject(){this.clear=!1,this.whatcontrolsmap=new Map,this.inwhatformgroup=null;let e=new Map;this.getDomainObject(this.isreadonly).forEach(t=>{e.set(t.name,t)}),this.inwhatformgroup=this.yobuilderservice.createFormGroup(e),this.whatcontrolsmap=this.yobuilderservice.createMap(e,this.inwhatformgroup);let t=new c.a("Cancel","cancel","cancel_presentation","secondary",!1),i=new c.a("Add User","register","lock_open","primary",!1);this.mybuttons.set("Action2",i),this.mybuttons.set("Action1",t),setTimeout(()=>{this.clear=!0},50)}putInSendRequest(e){if(e.checked&&(this.filterdetail.visitingto=this.processUserName(e.userName),this.filterdetail.visitingtoemail=e.email,this.filterdetail.visitingtonotificationid=e.notificationId,this.filterdetail.visitingtokey=e.$key,this.filterdetail.visitingtomob=e.mobile,this.getItems({target:{value:e.email}})),this.toSendItems.find(t=>t.email==e.email)){if(!e.checked)for(let t=0;t<this.toSendItems.length;t++)if(e.email===this.toSendItems[t].email){this.toSendItems.splice(t,1);break}}else e.checked&&this.toSendItems.push(e);this.startObject()}processUserName(e){if(e)return e.split("|")[0]}send(e){console.log("event",e);let t=+new Date;e.data.value.visitingtoemail&&(this.filterProf=this.prof.filter(t=>t.email.toLowerCase().indexOf(e.data.value.visitingtoemail.toLowerCase())>-1));let i=this.boardservice.generateInHistory(this.worker.$key,{indate:t,outdate:"",reason:e.data.value.reason,visitingto:e.data.value.visitingto,vehicalnum:e.data.value.vehicalnum,notes:e.data.value.notes,needParking:e.data.value.needParking}),a={in:"true",mobile:e.data.value.contactphone,statusdate:t,historykey:i.getKey(),needParking:e.data.value.needParking,vehicalnum:e.data.value.vehicalnum};this.workers.update(this.worker.$key,a);let n=e.data.value.contactname+" visiting to you [ "+e.data.value.reason+" ]";if(this.filterProf[0]){let e=this.authService.getUser(this.authService.getCurrentUserId()).valueChanges().subscribe(t=>{e&&e.unsubscribe(),this.boardservice.addtoInbox({date:+new Date,title:"Society Gate visit",message:n,sendby:t.userName,senderid:t.uid,senderemail:t.email,reciever:this.filterProf[0].$key?this.filterProf[0].$key:this.filterProf[0].key,candelete:!0,paymentmessage:!1,notificationmessage:!0,amount:0,read:!1,gatemessage:!0})})}this.ydataservice.getData("comingfrom")&&"outpage"==this.ydataservice.getData("comingfrom")?(this.ydataservice.clearData("comingfrom"),this.router.navigateByUrl("/inout/out")):this.router.navigateByUrl("/inout/in")}cancel(e){console.log(e),this.ygen.goBack()}}return e.\u0275fac=function(t){return new(t||e)(g.Qb(m.a),g.Qb(b.a),g.Qb(o.j),g.Qb(s.a),g.Qb(l.a),g.Qb(u.a))},e.\u0275cmp=g.Kb({type:e,selectors:[["app-enterdetail"]],decls:21,vars:5,consts:[["slot","start"],["royal","",3,"click"],["slot","icon-only","name","arrow-round-back"],[3,"placeholder","ionInput"],["padding",""],[4,"ngIf"],["mat-mini-fab","","aria-label","Example icon-button with a heart icon",1,"editable",3,"click"],[1,"box"],[3,"isreadonly","captchaOn","captchaName","whatform","whatformgroup","whichbuttons","actionEvent","cancelEvent",4,"ngIf"],["text-wrap","","class","searcheditems",4,"ngFor","ngForOf"],["text-wrap","",1,"searcheditems"],["color","dark","checked","false",3,"ngModel","ngModelChange","ionChange"],[3,"isreadonly","captchaOn","captchaName","whatform","whatformgroup","whichbuttons","actionEvent","cancelEvent"]],template:function(e,t){1&e&&(g.Wb(0,"ion-header"),g.Wb(1,"ion-toolbar"),g.Wb(2,"ion-buttons",0),g.Wb(3,"button",1),g.ec("click",(function(){return t.ygen.goBack()})),g.Rb(4,"ion-icon",2),g.Vb(),g.Vb(),g.Wb(5,"ion-title"),g.Mc(6,"Gate Pass"),g.Vb(),g.Vb(),g.Wb(7,"ion-toolbar"),g.Wb(8,"ion-searchbar",3),g.ec("ionInput",(function(e){return t.getItems(e)})),g.jc(9,"translate"),g.Vb(),g.Vb(),g.Vb(),g.Wb(10,"ion-content",4),g.Kc(11,C,4,3,"div",5),g.Wb(12,"ion-grid"),g.Wb(13,"ion-row"),g.Wb(14,"ion-col"),g.Wb(15,"button",6),g.ec("click",(function(){return t.changeReadOnly()})),g.Wb(16,"mat-icon"),g.Mc(17,"edit"),g.Vb(),g.Vb(),g.Wb(18,"mat-card"),g.Wb(19,"mat-card-content",7),g.Kc(20,D,1,6,"yogagainv2-dyanamic-page",8),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb(),g.Vb()),2&e&&(g.Db(8),g.sc("placeholder",g.kc(9,3,"Search Society Resident")),g.Db(3),g.rc("ngIf",(null==t.searchQuery?null:t.searchQuery.length)>=1),g.Db(9),g.rc("ngIf",t.clear))},directives:[r.y,r.fb,r.j,r.z,r.db,r.Q,r.sb,r.s,a.m,r.x,r.P,r.r,f.a,p.a,y.a,y.d,a.l,r.B,r.H,r.p,r.c,n.o,n.r,v.a],pipes:[w.c],styles:[".editable[_ngcontent-%COMP%]{position:absolute;left:93%;z-index:1}"]}),e})();var W=i("hVaU"),P=i("IZvt"),x=i("4pxM");const N=[{path:"",component:O}];let M=(()=>{class e{}return e.\u0275mod=g.Ob({type:e}),e.\u0275inj=g.Nb({factory:function(t){return new(t||e)},imports:[[a.c,n.i,r.gb,W.a,P.a,x.a,o.n.forChild(N)]]}),e})()}}]);