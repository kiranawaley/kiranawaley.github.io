(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{dhUD:function(e,t,n){"use strict";n.r(t),n.d(t,"OrdermanagementPageModule",(function(){return $}));var o=n("ofXK"),a=n("3Pt+"),i=n("tyNb"),s=n("TEn/"),r=n("rIxz"),c=n("+DAS"),d=n("gAVi"),b=n("YKLQ"),l=n("dMTE"),g=n("ybIa"),p=n("lJxs"),u=n("i2Ty"),h=n("0nTO"),y=n("TIpf"),m=n("cBbZ"),f=n("fXoL"),O=n("YCbS"),W=n("tuuX"),V=n("/per"),v=n("0pdN"),C=n("sYmb");function k(e,t){if(1&e){const e=f.Xb();f.Wb(0,"app-appicon",21),f.ec("actionEvent",(function(t){return f.Cc(e),f.ic().deleteOrders(t)})),f.Vb()}2&e&&f.rc("icon","delete")("askquestion",!0)("icontext","Remove All")("isiconwithtext",!0)}function D(e,t){if(1&e){const e=f.Xb();f.Wb(0,"ion-button",22),f.ec("click",(function(){return f.Cc(e),f.ic().downloadOrders()})),f.Rb(1,"ion-icon",23),f.Vb()}}function L(e,t){if(1&e){const e=f.Xb();f.Wb(0,"ion-toolbar",0),f.Wb(1,"ion-searchbar",24),f.ec("ngModelChange",(function(t){return f.Cc(e),f.ic().queryText=t})),f.jc(2,"translate"),f.Vb(),f.Vb()}if(2&e){const e=f.ic();f.rc("color","secondary"),f.Db(1),f.sc("placeholder",f.kc(2,3,"Search Order")),f.rc("ngModel",e.queryText)}}function M(e,t){1&e&&f.Rb(0,"ion-progress-bar",25)}function E(e,t){1&e&&(f.Wb(0,"div",39),f.Wb(1,"ion-label",40),f.Lc(2,"PAID "),f.Vb(),f.Vb())}function I(e,t){1&e&&(f.Wb(0,"div",41),f.Wb(1,"ion-label",40),f.Lc(2,"COD "),f.Vb(),f.Vb())}function N(e,t){if(1&e){const e=f.Xb();f.Wb(0,"app-appdelete",42),f.ec("actionEvent",(function(){f.Cc(e);const t=f.ic().$implicit;return f.ic(2).deleteNotice(t)})),f.Vb()}}function w(e,t){if(1&e){const e=f.Xb();f.Wb(0,"ion-card"),f.Jc(1,E,3,0,"div",27),f.Jc(2,I,3,0,"div",28),f.Wb(3,"ion-card-header"),f.Wb(4,"ion-card-subtitle"),f.Wb(5,"div"),f.Lc(6),f.Vb(),f.Wb(7,"div"),f.Lc(8),f.Vb(),f.Vb(),f.Wb(9,"ion-card-title"),f.Wb(10,"ion-chip",29),f.ec("click",(function(){f.Cc(e);const n=t.$implicit;return f.ic(2).ygen.routeto("/order",{orderid:n.$key})})),f.Wb(11,"ion-label"),f.Lc(12),f.Vb(),f.Rb(13,"ion-icon",30),f.Vb(),f.Wb(14,"ion-chip",31),f.ec("click",(function(){f.Cc(e);const n=t.$implicit;return f.ic(2).ygen.routeto("/order",{orderid:n.$key})})),f.Wb(15,"ion-label"),f.Lc(16),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Wb(17,"ion-card-content"),f.Wb(18,"table",32),f.Wb(19,"tbody"),f.Wb(20,"tr"),f.Wb(21,"td",33),f.Lc(22," By "),f.Vb(),f.Wb(23,"td",34),f.Lc(24),f.Vb(),f.Vb(),f.Wb(25,"tr"),f.Wb(26,"td",33),f.Lc(27," Items "),f.Vb(),f.Wb(28,"td",34),f.Lc(29),f.Vb(),f.Vb(),f.Wb(30,"tr"),f.Wb(31,"td",33),f.Lc(32," Address "),f.Vb(),f.Wb(33,"td",34),f.Lc(34),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Wb(35,"ion-item"),f.Jc(36,N,1,0,"app-appdelete",35),f.Wb(37,"app-apporderstatus",36),f.ec("actionEvent",(function(n){f.Cc(e);const o=t.$implicit;return f.ic(2).takeAcion(n,o)})),f.Vb(),f.Wb(38,"div",37),f.Rb(39,"app-callphone",38),f.Vb(),f.Vb(),f.Vb()}if(2&e){const e=t.$implicit,n=f.ic(2);f.Db(1),f.rc("ngIf","PNO"==e.paymentmethod&&"Success"==(null==e.paymentResponse?null:e.paymentResponse.order_status)),f.Db(1),f.rc("ngIf","COD"==e.paymentmethod),f.Db(4),f.Nc("On ",n.ygen.formatTimestampToDate(e.odt),""),f.Db(2),f.Mc(n.ygen.sincewhen(e.odt)),f.Db(4),f.Mc(e.sendorderid),f.Db(4),f.Nc("Rs ",e.amount,""),f.Db(8),f.Nc(" ",e.orderByName," "),f.Db(5),f.Nc(" ",n.getItemCount(e)," "),f.Db(5),f.Nc(" ",e.deliveryAddress," "),f.Db(2),f.rc("ngIf",!("COMPLETED"==e.ostatus||"CANCELLED"==e.ostatus)),f.Db(1),f.rc("currentvalue",e.ostatus)("orderstatus",n.ygen.orderstatus),f.Db(2),f.rc("mobile",e.orderByPhone)}}function x(e,t){if(1&e&&(f.Wb(0,"div"),f.Jc(1,w,40,13,"ion-card",26),f.Lc(2),f.Vb()),2&e){const e=t.ngIf,n=f.ic();f.Db(1),f.rc("ngForOf",e),f.Db(1),f.Nc(" ",n.getTotal(e)," ")}}let P=(()=>{class e{constructor(e,t,n,o,a,i,s,r,c,d,b){this.modalCtrl=e,this.router=t,this.yalert=n,this.ygen=o,this.ydataservice=a,this.ystorageservice=i,this.ypay=s,this.yds=r,this.ynoti=c,this.excelservice=d,this.events=b,this.queryText="",this.segment="NEW",this.segmenttotal=new Map,this.total=0,this.orderlist=new g.a("/shop/orders",this.ydataservice.getDatabase(),!0,null),this.setSegmentTotal()}ngOnInit(){console.log("yeah....ngoninit")}ionViewWillEnter(){console.log("yeah....ion enter"),this.myinbox=this.getData(this.segment)}deleteNotice(e){this.orderlist.removefromList(e)}deleteOrders(e){this.orderlist.getListRefer().remove()}takeAcion(e,t){Object.assign(t,{ostatus:e.value}),this.orderlist.updateList(t),this.yalert.openSnackBar(`Order Status changed for [${t.sendorderid}]`,"Ok"),this.ynoti.orderstatuschange(`Order Status changed to [${e.value}] for [${t.sendorderid}]`,t)}putinprocess(e){Object.assign(e,{ostatus:"INPROCESS"}),this.orderlist.updateList(e),this.ynoti.orderstatuschange(`Order Status changed to [${e.ostatus}] for [${e.sendorderid}]`,e),this.events.publish("shop:alertsubscription",{})}completeorder(e){Object.assign(e,{ostatus:"COMPLETED"}),this.orderlist.updateList(e),this.ynoti.orderstatuschange(`Congratulation you Order Status changed to [${e.ostatus}] for [${e.sendorderid}]`,e)}getItemCount(e){return e.payload?e.payload.length:0}getTitle(e){return e.read?"Mark Unread":"Mark Read"}segmentChanged(e){console.log("segment",e),this.myinbox=this.getData(e.detail.value)}getData(e){return this.ygen.isAdmin()?this.getOrders(e):this.getMyOrders(e)}getOrders(e){return"NEW"===e?this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(e=>Object.assign({$key:e.payload.key},e.payload.val())).filter(t=>t.ostatus==e||!t.ostatus)),Object(p.a)(e=>e.reverse())):this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(e=>Object.assign({$key:e.payload.key},e.payload.val())).filter(t=>t.ostatus==e)),Object(p.a)(e=>e.reverse()))}getMyOrders(e){return"NEW"===e?this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(e=>Object.assign({$key:e.payload.key},e.payload.val())).filter(t=>(t.ostatus==e||!t.ostatus)&&t.orderedBy==this.ygen.getUid())),Object(p.a)(e=>e.reverse())):this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(e=>Object.assign({$key:e.payload.key},e.payload.val())).filter(t=>t.ostatus==e&&t.orderedBy==this.ygen.getUid())),Object(p.a)(e=>e.reverse()))}getTotal(e){this.total=0,e.forEach(e=>{this.total=this.total+e.amount})}setSegmentTotal(){this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(e=>Object.assign({$key:e.payload.key},e.payload.val())))).subscribe(e=>{this.ygen.orderstatus.forEach(t=>{this.segmenttotal.set(t.value,e.filter(e=>e.ostatus==t.value).length)})})}navigate(e,t){console.log()}downloadOrders(){let e=this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(e=>Object.assign({$key:e.payload.key},e.payload.val())))).subscribe(t=>{console.log("list",t);let n=[];t.forEach(e=>{let t={orderid:e.sendorderid,amount:e.amount,paymentmethod:e.paymentmethod,deliveryAddress:e.deliveryAddress,name:e.orderByName,phone:e.orderByPhone,orderstatus:e.ostatus,dateoforder:this.ygen.formatTimestampToDate(e.odt),orderitems:this.getpayload(e.payload),paymentstatus:this.paymentdone(e),payment_id:this.paymentid(e)};n.push(t)}),0==n.length?this.yalert.openSnackBar("No orders for downlowd","Ok"):(this.excelservice.exportAsExcelFile(n,"orders"),this.yalert.openSnackBar("Orders will be downloaded...","Ok")),e.unsubscribe()})}getpayload(e){let t="";return e.forEach(e=>{t=t+e.title+"| "+e.description+"| Rs="+e.price+"| Total Items=["+e.orderqty+"] ||"}),t}paymentdone(e){let t="NOT PAID";return e.paymentResponse&&"Success"==e.paymentResponse.order_status&&(t="PAID"),t}paymentid(e){let t="";return e.paymentResponse&&(t=e.paymentResponse.payment_id),t}}return e.\u0275fac=function(t){return new(t||e)(f.Qb(s.fb),f.Qb(i.g),f.Qb(u.a),f.Qb(r.a),f.Qb(c.a),f.Qb(d.a),f.Qb(l.a),f.Qb(b.a),f.Qb(h.a),f.Qb(y.a),f.Qb(m.a))},e.\u0275cmp=f.Kb({type:e,selectors:[["app-ordermanagement"]],decls:50,vars:30,consts:[[3,"color"],["slot","start"],["slot","end","color","secondary"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent",4,"ngIf"],["class","download","color","danger",3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],[3,"ngModel","ngModelChange","ionChange"],["value","NEW"],["color","danger"],["value","INPROCESS"],["color","dark"],["value","COMPLETED"],["color","success"],["value","CANCELLED"],["color","tertiary"],[3,"color",4,"ngIf"],["padding",""],["loading",""],[4,"ngIf","ngIfElse"],[1,"footerCartSection"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent"],["color","danger",1,"download",3,"click"],["slot","icon-only","name","code-download"],[3,"ngModel","placeholder","ngModelChange"],["type","indeterminate","reversed","true"],[4,"ngFor","ngForOf"],["class","paySection",4,"ngIf"],["class","codSection",4,"ngIf"],["color","secondary",3,"click"],["name","eye"],["color","primary",3,"click"],[1,"contentorder"],[1,"labelt"],[1,"valuet"],["icon","delete","message","delete",3,"actionEvent",4,"ngIf"],[3,"currentvalue","orderstatus","actionEvent"],[2,"padding","5px"],[3,"mobile"],[1,"paySection"],["text-uppercase","",1,"sc-ion-label-md-h","sc-ion-label-md-s","hydrated"],[1,"codSection"],["icon","delete","message","delete",3,"actionEvent"]],template:function(e,t){if(1&e&&(f.Wb(0,"ion-header"),f.Wb(1,"ion-toolbar",0),f.Wb(2,"ion-buttons",1),f.Rb(3,"ion-back-button"),f.Vb(),f.Wb(4,"ion-title"),f.Lc(5),f.jc(6,"translate"),f.Vb(),f.Wb(7,"ion-buttons",2),f.Jc(8,k,1,4,"app-appicon",3),f.Jc(9,D,2,0,"ion-button",4),f.Wb(10,"ion-button",5),f.ec("click",(function(){return t.ygen.routeto("searchorder",{})})),f.Rb(11,"ion-icon",6),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Wb(12,"ion-header"),f.Wb(13,"ion-toolbar",0),f.Wb(14,"ion-segment",7),f.ec("ngModelChange",(function(e){return t.segment=e}))("ionChange",(function(e){return t.segmentChanged(e)})),f.Wb(15,"ion-segment-button",8),f.Lc(16),f.jc(17,"translate"),f.Wb(18,"ion-badge",9),f.Lc(19),f.Vb(),f.Vb(),f.Wb(20,"ion-segment-button",10),f.Lc(21),f.jc(22,"translate"),f.Wb(23,"ion-badge",11),f.Lc(24),f.Vb(),f.Vb(),f.Wb(25,"ion-segment-button",12),f.Lc(26),f.jc(27,"translate"),f.Wb(28,"ion-badge",13),f.Lc(29),f.Vb(),f.Vb(),f.Wb(30,"ion-segment-button",14),f.Lc(31),f.jc(32,"translate"),f.Wb(33,"ion-badge",15),f.Lc(34),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Jc(35,L,3,5,"ion-toolbar",16),f.Vb(),f.Wb(36,"ion-content",17),f.Jc(37,M,1,0,"ng-template",null,18,f.Kc),f.Jc(39,x,3,2,"div",19),f.jc(40,"async"),f.Vb(),f.Wb(41,"ion-footer"),f.Wb(42,"ion-toolbar"),f.Wb(43,"div",20),f.Wb(44,"ion-text"),f.Wb(45,"h3"),f.Lc(46,"Total"),f.Vb(),f.Vb(),f.Wb(47,"ion-text"),f.Wb(48,"h3"),f.Lc(49),f.Vb(),f.Vb(),f.Vb(),f.Vb(),f.Vb()),2&e){const e=f.zc(38);f.Db(1),f.rc("color","warning"),f.Db(4),f.Mc(f.kc(6,18,"Order Management")),f.Db(3),f.rc("ngIf",t.ygen.isAdmin()),f.Db(1),f.rc("ngIf",t.ygen.isAdmin()),f.Db(4),f.rc("color","warning"),f.Db(1),f.rc("ngModel",t.segment),f.Db(2),f.Nc(" ",f.kc(17,20,"New"),""),f.Db(3),f.Mc(t.segmenttotal.get("NEW")),f.Db(2),f.Nc(" ",f.kc(22,22,"InProcess"),""),f.Db(3),f.Mc(t.segmenttotal.get("INPROCESS")),f.Db(2),f.Nc(" ",f.kc(27,24,"Completed"),""),f.Db(3),f.Mc(t.segmenttotal.get("COMPLETED")),f.Db(2),f.Nc(" ",f.kc(32,26,"Cancelled"),""),f.Db(3),f.Mc(t.segmenttotal.get("CANCELLED")),f.Db(1),f.rc("ngIf",0),f.Db(4),f.rc("ngIf",f.kc(40,28,t.myinbox))("ngIfElse",e),f.Db(10),f.Nc(" \u20b9 ",t.total," ")}},directives:[s.v,s.ab,s.j,s.f,s.g,s.Y,o.m,s.i,s.w,s.M,s.lb,a.n,a.q,s.N,s.h,s.s,s.t,s.V,O.a,s.L,s.mb,s.I,o.l,s.k,s.m,s.n,s.o,s.q,s.C,s.l,s.y,W.a,V.a,v.a],pipes:[C.c,o.b],styles:[".otitle[_ngcontent-%COMP%]{font-size:14px}.orderid[_ngcontent-%COMP%]{font-size:10px}.orderamt[_ngcontent-%COMP%]{font-size:18px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:0}tbody[_ngcontent-%COMP%]{font-size:small}.labelt[_ngcontent-%COMP%]{font-weight:lighter}.valuet[_ngcontent-%COMP%]{padding-left:10px}ion-card-content[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.paySection[_ngcontent-%COMP%]{background:#15bf15}.codSection[_ngcontent-%COMP%], .paySection[_ngcontent-%COMP%]{color:#fff;position:absolute;padding:6px 16px;border-radius:5px;font-weight:700;right:10px}.codSection[_ngcontent-%COMP%]{background:#de66cf}ion-card-title[_ngcontent-%COMP%]{padding-bottom:0;background:#f5fffa}.download[_ngcontent-%COMP%]{font-size:30px;font-weight:700}"]}),e})();var S=n("hVaU"),j=n("IZvt"),R=n("4pxM");const T=[{path:"",component:P}];let $=(()=>{class e{}return e.\u0275mod=f.Ob({type:e}),e.\u0275inj=f.Nb({factory:function(t){return new(t||e)},imports:[[o.c,a.i,s.bb,S.a,j.a,R.a,i.k.forChild(T)]]}),e})()}}]);