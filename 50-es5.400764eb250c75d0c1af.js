function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{dhUD:function(e,t,n){"use strict";n.r(t),n.d(t,"OrdermanagementPageModule",(function(){return $}));var o=n("ofXK"),a=n("3Pt+"),r=n("tyNb"),i=n("TEn/"),c=n("rIxz"),s=n("+DAS"),l=n("gAVi"),d=n("YKLQ"),b=n("dMTE"),u=n("ybIa"),g=n("lJxs"),p=n("i2Ty"),f=n("0nTO"),y=n("TIpf"),h=n("cBbZ"),m=n("fXoL"),v=n("YCbS"),k=n("tuuX"),C=n("/per"),O=n("0pdN"),W=n("sYmb");function V(e,t){if(1&e){var n=m.Xb();m.Wb(0,"app-appicon",21),m.ec("actionEvent",(function(e){return m.Cc(n),m.ic().deleteOrders(e)})),m.Vb()}2&e&&m.rc("icon","delete")("askquestion",!0)("icontext","Remove All")("isiconwithtext",!0)}function D(e,t){if(1&e){var n=m.Xb();m.Wb(0,"ion-button",22),m.ec("click",(function(){return m.Cc(n),m.ic().downloadOrders()})),m.Rb(1,"ion-icon",23),m.Vb()}}function L(e,t){if(1&e){var n=m.Xb();m.Wb(0,"ion-toolbar",0),m.Wb(1,"ion-searchbar",24),m.ec("ngModelChange",(function(e){return m.Cc(n),m.ic().queryText=e})),m.jc(2,"translate"),m.Vb(),m.Vb()}if(2&e){var o=m.ic();m.rc("color","secondary"),m.Db(1),m.sc("placeholder",m.kc(2,3,"Search Order")),m.rc("ngModel",o.queryText)}}function M(e,t){1&e&&m.Rb(0,"ion-progress-bar",25)}function E(e,t){1&e&&(m.Wb(0,"div",39),m.Wb(1,"ion-label",40),m.Lc(2,"PAID "),m.Vb(),m.Vb())}function w(e,t){1&e&&(m.Wb(0,"div",41),m.Wb(1,"ion-label",40),m.Lc(2,"COD "),m.Vb(),m.Vb())}function P(e,t){if(1&e){var n=m.Xb();m.Wb(0,"app-appdelete",42),m.ec("actionEvent",(function(){m.Cc(n);var e=m.ic().$implicit;return m.ic(2).deleteNotice(e)})),m.Vb()}}function I(e,t){if(1&e){var n=m.Xb();m.Wb(0,"ion-card"),m.Jc(1,E,3,0,"div",27),m.Jc(2,w,3,0,"div",28),m.Wb(3,"ion-card-header"),m.Wb(4,"ion-card-subtitle"),m.Wb(5,"div"),m.Lc(6),m.Vb(),m.Wb(7,"div"),m.Lc(8),m.Vb(),m.Vb(),m.Wb(9,"ion-card-title"),m.Wb(10,"ion-chip",29),m.ec("click",(function(){m.Cc(n);var e=t.$implicit;return m.ic(2).ygen.routeto("/order",{orderid:e.$key})})),m.Wb(11,"ion-label"),m.Lc(12),m.Vb(),m.Rb(13,"ion-icon",30),m.Vb(),m.Wb(14,"ion-chip",31),m.ec("click",(function(){m.Cc(n);var e=t.$implicit;return m.ic(2).ygen.routeto("/order",{orderid:e.$key})})),m.Wb(15,"ion-label"),m.Lc(16),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(17,"ion-card-content"),m.Wb(18,"table",32),m.Wb(19,"tbody"),m.Wb(20,"tr"),m.Wb(21,"td",33),m.Lc(22," By "),m.Vb(),m.Wb(23,"td",34),m.Lc(24),m.Vb(),m.Vb(),m.Wb(25,"tr"),m.Wb(26,"td",33),m.Lc(27," Items "),m.Vb(),m.Wb(28,"td",34),m.Lc(29),m.Vb(),m.Vb(),m.Wb(30,"tr"),m.Wb(31,"td",33),m.Lc(32," Address "),m.Vb(),m.Wb(33,"td",34),m.Lc(34),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(35,"ion-item"),m.Jc(36,P,1,0,"app-appdelete",35),m.Wb(37,"app-apporderstatus",36),m.ec("actionEvent",(function(e){m.Cc(n);var o=t.$implicit;return m.ic(2).takeAcion(e,o)})),m.Vb(),m.Wb(38,"div",37),m.Rb(39,"app-callphone",38),m.Vb(),m.Vb(),m.Vb()}if(2&e){var o=t.$implicit,a=m.ic(2);m.Db(1),m.rc("ngIf","PNO"==o.paymentmethod&&"Success"==(null==o.paymentResponse?null:o.paymentResponse.order_status)),m.Db(1),m.rc("ngIf","COD"==o.paymentmethod),m.Db(4),m.Nc("On ",a.ygen.formatTimestampToDate(o.odt),""),m.Db(2),m.Mc(a.ygen.sincewhen(o.odt)),m.Db(4),m.Mc(o.sendorderid),m.Db(4),m.Nc("Rs ",o.amount,""),m.Db(8),m.Nc(" ",o.orderByName," "),m.Db(5),m.Nc(" ",a.getItemCount(o)," "),m.Db(5),m.Nc(" ",o.deliveryAddress," "),m.Db(2),m.rc("ngIf",!("COMPLETED"==o.ostatus||"CANCELLED"==o.ostatus)),m.Db(1),m.rc("currentvalue",o.ostatus)("orderstatus",a.ygen.orderstatus),m.Db(2),m.rc("mobile",o.orderByPhone)}}function N(e,t){if(1&e&&(m.Wb(0,"div"),m.Jc(1,I,40,13,"ion-card",26),m.Lc(2),m.Vb()),2&e){var n=t.ngIf,o=m.ic();m.Db(1),m.rc("ngForOf",n),m.Db(1),m.Nc(" ",o.getTotal(n)," ")}}var x,j,S=((x=function(){function e(t,n,o,a,r,i,c,s,l,d,b){_classCallCheck(this,e),this.modalCtrl=t,this.router=n,this.yalert=o,this.ygen=a,this.ydataservice=r,this.ystorageservice=i,this.ypay=c,this.yds=s,this.ynoti=l,this.excelservice=d,this.events=b,this.queryText="",this.segment="NEW",this.segmenttotal=new Map,this.total=0,this.orderlist=new u.a("/shop/orders",this.ydataservice.getDatabase(),!0,null),this.setSegmentTotal()}return _createClass(e,[{key:"ngOnInit",value:function(){console.log("yeah....ngoninit")}},{key:"ionViewWillEnter",value:function(){console.log("yeah....ion enter"),this.myinbox=this.getData(this.segment)}},{key:"deleteNotice",value:function(e){this.orderlist.removefromList(e)}},{key:"deleteOrders",value:function(e){this.orderlist.getListRefer().remove()}},{key:"takeAcion",value:function(e,t){Object.assign(t,{ostatus:e.value}),this.orderlist.updateList(t),this.yalert.openSnackBar("Order Status changed for [".concat(t.sendorderid,"]"),"Ok"),this.ynoti.orderstatuschange("Order Status changed to [".concat(e.value,"] for [").concat(t.sendorderid,"]"),t)}},{key:"putinprocess",value:function(e){Object.assign(e,{ostatus:"INPROCESS"}),this.orderlist.updateList(e),this.ynoti.orderstatuschange("Order Status changed to [".concat(e.ostatus,"] for [").concat(e.sendorderid,"]"),e),this.events.publish("shop:alertsubscription",{})}},{key:"completeorder",value:function(e){Object.assign(e,{ostatus:"COMPLETED"}),this.orderlist.updateList(e),this.ynoti.orderstatuschange("Congratulation you Order Status changed to [".concat(e.ostatus,"] for [").concat(e.sendorderid,"]"),e)}},{key:"getItemCount",value:function(e){return e.payload?e.payload.length:0}},{key:"getTitle",value:function(e){return e.read?"Mark Unread":"Mark Read"}},{key:"segmentChanged",value:function(e){console.log("segment",e),this.myinbox=this.getData(e.detail.value)}},{key:"getData",value:function(e){return this.ygen.isAdmin()?this.getOrders(e):this.getMyOrders(e)}},{key:"getOrders",value:function(e){return"NEW"===e?this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(t){return t.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())})).filter((function(t){return t.ostatus==e||!t.ostatus}))})),Object(g.a)((function(e){return e.reverse()}))):this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(t){return t.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())})).filter((function(t){return t.ostatus==e}))})),Object(g.a)((function(e){return e.reverse()})))}},{key:"getMyOrders",value:function(e){var t=this;return"NEW"===e?this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(n){return n.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())})).filter((function(n){return(n.ostatus==e||!n.ostatus)&&n.orderedBy==t.ygen.getUid()}))})),Object(g.a)((function(e){return e.reverse()}))):this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(n){return n.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())})).filter((function(n){return n.ostatus==e&&n.orderedBy==t.ygen.getUid()}))})),Object(g.a)((function(e){return e.reverse()})))}},{key:"getTotal",value:function(e){var t=this;this.total=0,e.forEach((function(e){t.total=t.total+e.amount}))}},{key:"setSegmentTotal",value:function(){var e=this;this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(e){return e.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())}))}))).subscribe((function(t){e.ygen.orderstatus.forEach((function(n){e.segmenttotal.set(n.value,t.filter((function(e){return e.ostatus==n.value})).length)}))}))}},{key:"navigate",value:function(e,t){console.log()}},{key:"downloadOrders",value:function(){var e=this,t=this.orderlist.getListRefer().snapshotChanges().pipe(Object(g.a)((function(e){return e.map((function(e){return Object.assign({$key:e.payload.key},e.payload.val())}))}))).subscribe((function(n){console.log("list",n);var o=[];n.forEach((function(t){var n={orderid:t.sendorderid,amount:t.amount,paymentmethod:t.paymentmethod,deliveryAddress:t.deliveryAddress,name:t.orderByName,phone:t.orderByPhone,orderstatus:t.ostatus,dateoforder:e.ygen.formatTimestampToDate(t.odt),orderitems:e.getpayload(t.payload),paymentstatus:e.paymentdone(t),payment_id:e.paymentid(t)};o.push(n)})),0==o.length?e.yalert.openSnackBar("No orders for downlowd","Ok"):(e.excelservice.exportAsExcelFile(o,"orders"),e.yalert.openSnackBar("Orders will be downloaded...","Ok")),t.unsubscribe()}))}},{key:"getpayload",value:function(e){var t="";return e.forEach((function(e){t=t+e.title+"| "+e.description+"| Rs="+e.price+"| Total Items=["+e.orderqty+"] ||"})),t}},{key:"paymentdone",value:function(e){var t="NOT PAID";return e.paymentResponse&&"Success"==e.paymentResponse.order_status&&(t="PAID"),t}},{key:"paymentid",value:function(e){var t="";return e.paymentResponse&&(t=e.paymentResponse.payment_id),t}}]),e}()).\u0275fac=function(e){return new(e||x)(m.Qb(i.fb),m.Qb(r.g),m.Qb(p.a),m.Qb(c.a),m.Qb(s.a),m.Qb(l.a),m.Qb(b.a),m.Qb(d.a),m.Qb(f.a),m.Qb(y.a),m.Qb(h.a))},x.\u0275cmp=m.Kb({type:x,selectors:[["app-ordermanagement"]],decls:50,vars:30,consts:[[3,"color"],["slot","start"],["slot","end","color","secondary"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent",4,"ngIf"],["class","download","color","danger",3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],[3,"ngModel","ngModelChange","ionChange"],["value","NEW"],["color","danger"],["value","INPROCESS"],["color","dark"],["value","COMPLETED"],["color","success"],["value","CANCELLED"],["color","tertiary"],[3,"color",4,"ngIf"],["padding",""],["loading",""],[4,"ngIf","ngIfElse"],[1,"footerCartSection"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent"],["color","danger",1,"download",3,"click"],["slot","icon-only","name","code-download"],[3,"ngModel","placeholder","ngModelChange"],["type","indeterminate","reversed","true"],[4,"ngFor","ngForOf"],["class","paySection",4,"ngIf"],["class","codSection",4,"ngIf"],["color","secondary",3,"click"],["name","eye"],["color","primary",3,"click"],[1,"contentorder"],[1,"labelt"],[1,"valuet"],["icon","delete","message","delete",3,"actionEvent",4,"ngIf"],[3,"currentvalue","orderstatus","actionEvent"],[2,"padding","5px"],[3,"mobile"],[1,"paySection"],["text-uppercase","",1,"sc-ion-label-md-h","sc-ion-label-md-s","hydrated"],[1,"codSection"],["icon","delete","message","delete",3,"actionEvent"]],template:function(e,t){if(1&e&&(m.Wb(0,"ion-header"),m.Wb(1,"ion-toolbar",0),m.Wb(2,"ion-buttons",1),m.Rb(3,"ion-back-button"),m.Vb(),m.Wb(4,"ion-title"),m.Lc(5),m.jc(6,"translate"),m.Vb(),m.Wb(7,"ion-buttons",2),m.Jc(8,V,1,4,"app-appicon",3),m.Jc(9,D,2,0,"ion-button",4),m.Wb(10,"ion-button",5),m.ec("click",(function(){return t.ygen.routeto("searchorder",{})})),m.Rb(11,"ion-icon",6),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Wb(12,"ion-header"),m.Wb(13,"ion-toolbar",0),m.Wb(14,"ion-segment",7),m.ec("ngModelChange",(function(e){return t.segment=e}))("ionChange",(function(e){return t.segmentChanged(e)})),m.Wb(15,"ion-segment-button",8),m.Lc(16),m.jc(17,"translate"),m.Wb(18,"ion-badge",9),m.Lc(19),m.Vb(),m.Vb(),m.Wb(20,"ion-segment-button",10),m.Lc(21),m.jc(22,"translate"),m.Wb(23,"ion-badge",11),m.Lc(24),m.Vb(),m.Vb(),m.Wb(25,"ion-segment-button",12),m.Lc(26),m.jc(27,"translate"),m.Wb(28,"ion-badge",13),m.Lc(29),m.Vb(),m.Vb(),m.Wb(30,"ion-segment-button",14),m.Lc(31),m.jc(32,"translate"),m.Wb(33,"ion-badge",15),m.Lc(34),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Jc(35,L,3,5,"ion-toolbar",16),m.Vb(),m.Wb(36,"ion-content",17),m.Jc(37,M,1,0,"ng-template",null,18,m.Kc),m.Jc(39,N,3,2,"div",19),m.jc(40,"async"),m.Vb(),m.Wb(41,"ion-footer"),m.Wb(42,"ion-toolbar"),m.Wb(43,"div",20),m.Wb(44,"ion-text"),m.Wb(45,"h3"),m.Lc(46,"Total"),m.Vb(),m.Vb(),m.Wb(47,"ion-text"),m.Wb(48,"h3"),m.Lc(49),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&e){var n=m.zc(38);m.Db(1),m.rc("color","warning"),m.Db(4),m.Mc(m.kc(6,18,"Order Management")),m.Db(3),m.rc("ngIf",t.ygen.isAdmin()),m.Db(1),m.rc("ngIf",t.ygen.isAdmin()),m.Db(4),m.rc("color","warning"),m.Db(1),m.rc("ngModel",t.segment),m.Db(2),m.Nc(" ",m.kc(17,20,"New"),""),m.Db(3),m.Mc(t.segmenttotal.get("NEW")),m.Db(2),m.Nc(" ",m.kc(22,22,"InProcess"),""),m.Db(3),m.Mc(t.segmenttotal.get("INPROCESS")),m.Db(2),m.Nc(" ",m.kc(27,24,"Completed"),""),m.Db(3),m.Mc(t.segmenttotal.get("COMPLETED")),m.Db(2),m.Nc(" ",m.kc(32,26,"Cancelled"),""),m.Db(3),m.Mc(t.segmenttotal.get("CANCELLED")),m.Db(1),m.rc("ngIf",0),m.Db(4),m.rc("ngIf",m.kc(40,28,t.myinbox))("ngIfElse",n),m.Db(10),m.Nc(" \u20b9 ",t.total," ")}},directives:[i.v,i.ab,i.j,i.f,i.g,i.Y,o.m,i.i,i.w,i.M,i.lb,a.n,a.q,i.N,i.h,i.s,i.t,i.V,v.a,i.L,i.mb,i.I,o.l,i.k,i.m,i.n,i.o,i.q,i.C,i.l,i.y,k.a,C.a,O.a],pipes:[W.c,o.b],styles:[".otitle[_ngcontent-%COMP%]{font-size:14px}.orderid[_ngcontent-%COMP%]{font-size:10px}.orderamt[_ngcontent-%COMP%]{font-size:18px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:0}tbody[_ngcontent-%COMP%]{font-size:small}.labelt[_ngcontent-%COMP%]{font-weight:lighter}.valuet[_ngcontent-%COMP%]{padding-left:10px}ion-card-content[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.paySection[_ngcontent-%COMP%]{background:#15bf15}.codSection[_ngcontent-%COMP%], .paySection[_ngcontent-%COMP%]{color:#fff;position:absolute;padding:6px 16px;border-radius:5px;font-weight:700;right:10px}.codSection[_ngcontent-%COMP%]{background:#de66cf}ion-card-title[_ngcontent-%COMP%]{padding-bottom:0;background:#f5fffa}.download[_ngcontent-%COMP%]{font-size:30px;font-weight:700}"]}),x),_=n("hVaU"),R=n("IZvt"),T=n("4pxM"),A=[{path:"",component:S}],$=((j=function e(){_classCallCheck(this,e)}).\u0275mod=m.Ob({type:j}),j.\u0275inj=m.Nb({factory:function(e){return new(e||j)},imports:[[o.c,a.i,i.bb,_.a,R.a,T.a,r.k.forChild(A)]]}),j)}}]);