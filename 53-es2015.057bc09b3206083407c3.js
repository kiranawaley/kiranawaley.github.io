(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{dhUD:function(t,e,n){"use strict";n.r(e),n.d(e,"OrdermanagementPageModule",(function(){return Q}));var o=n("ofXK"),i=n("3Pt+"),a=n("tyNb"),c=n("TEn/"),r=n("mrSG"),s=n("rIxz"),b=n("+DAS"),d=n("gAVi"),l=n("YKLQ"),g=n("dMTE"),u=n("ybIa"),p=n("lJxs"),h=n("i2Ty"),f=n("0nTO"),y=n("TIpf"),m=n("cBbZ"),O=n("G2i7"),W=n("fXoL"),v=n("YCbS"),V=n("tuuX"),k=n("/per"),C=n("0pdN"),M=n("sYmb");function D(t,e){if(1&t){const t=W.Xb();W.Wb(0,"app-appicon",22),W.ec("actionEvent",(function(e){return W.Cc(t),W.ic().deleteOrders(e)})),W.Vb()}2&t&&W.rc("icon","delete")("askquestion",!0)("icontext","Remove All")("isiconwithtext",!0)}function E(t,e){if(1&t){const t=W.Xb();W.Wb(0,"ion-button",23),W.ec("click",(function(){return W.Cc(t),W.ic().downloadOrders()})),W.Rb(1,"ion-icon",24),W.Vb()}}function S(t,e){if(1&t){const t=W.Xb();W.Wb(0,"ion-toolbar",0),W.Wb(1,"ion-searchbar",25),W.ec("ngModelChange",(function(e){return W.Cc(t),W.ic().queryText=e})),W.jc(2,"translate"),W.Vb(),W.Vb()}if(2&t){const t=W.ic();W.rc("color","secondary"),W.Db(1),W.sc("placeholder",W.kc(2,3,"Search Order")),W.rc("ngModel",t.queryText)}}function w(t,e){1&t&&W.Rb(0,"ion-progress-bar",26)}function I(t,e){1&t&&(W.Wb(0,"div",40),W.Wb(1,"ion-label",41),W.Mc(2,"PAID "),W.Vb(),W.Vb())}function P(t,e){1&t&&(W.Wb(0,"div",42),W.Wb(1,"ion-label",41),W.Mc(2,"COD "),W.Vb(),W.Vb())}function j(t,e){if(1&t){const t=W.Xb();W.Wb(0,"app-appdelete",43),W.ec("actionEvent",(function(){W.Cc(t);const e=W.ic().$implicit;return W.ic(2).deleteNotice(e)})),W.Vb()}}function x(t,e){if(1&t){const t=W.Xb();W.Wb(0,"ion-card"),W.Kc(1,I,3,0,"div",28),W.Kc(2,P,3,0,"div",29),W.Wb(3,"ion-card-header"),W.Wb(4,"ion-card-subtitle"),W.Wb(5,"div"),W.Mc(6),W.Vb(),W.Wb(7,"div"),W.Mc(8),W.Vb(),W.Vb(),W.Wb(9,"ion-card-title"),W.Wb(10,"ion-chip",30),W.ec("click",(function(){W.Cc(t);const n=e.$implicit;return W.ic(2).ygen.routeto("/order",{orderid:n.$key})})),W.Wb(11,"ion-label"),W.Mc(12),W.Vb(),W.Rb(13,"ion-icon",31),W.Vb(),W.Wb(14,"ion-chip",32),W.ec("click",(function(){W.Cc(t);const n=e.$implicit;return W.ic(2).ygen.routeto("/order",{orderid:n.$key})})),W.Wb(15,"ion-label"),W.Mc(16),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Wb(17,"ion-card-content"),W.Wb(18,"table",33),W.Wb(19,"tbody"),W.Wb(20,"tr"),W.Wb(21,"td",34),W.Mc(22),W.jc(23,"translate"),W.Vb(),W.Wb(24,"td",35),W.Mc(25),W.Vb(),W.Vb(),W.Wb(26,"tr"),W.Wb(27,"td",34),W.Mc(28),W.jc(29,"translate"),W.Vb(),W.Wb(30,"td",35),W.Mc(31),W.Vb(),W.Vb(),W.Wb(32,"tr"),W.Wb(33,"td",34),W.Mc(34),W.jc(35,"translate"),W.Vb(),W.Wb(36,"td",35),W.Mc(37),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Wb(38,"ion-item"),W.Kc(39,j,1,0,"app-appdelete",36),W.Wb(40,"app-apporderstatus",37),W.ec("actionEvent",(function(n){W.Cc(t);const o=e.$implicit;return W.ic(2).takeAcion(n,o)})),W.Vb(),W.Wb(41,"div",38),W.Rb(42,"app-callphone",39),W.Vb(),W.Vb(),W.Vb()}if(2&t){const t=e.$implicit,n=W.ic(2);W.Db(1),W.rc("ngIf","PNO"==t.paymentmethod&&"Success"==(null==t.paymentResponse?null:t.paymentResponse.order_status)),W.Db(1),W.rc("ngIf","COD"==t.paymentmethod),W.Db(4),W.Oc("On ",n.ygen.formatTimestampToDate(t.odt),""),W.Db(2),W.Nc(n.ygen.sincewhen(t.odt)),W.Db(4),W.Nc(t.sendorderid),W.Db(4),W.Pc("",n.ygen.getcurrencysymbol()," ",t.amount,""),W.Db(6),W.Oc(" ",W.kc(23,17,"By")," "),W.Db(3),W.Oc(" ",t.orderByName," "),W.Db(3),W.Oc(" ",W.kc(29,19,"Items")," "),W.Db(3),W.Oc(" ",n.getItemCount(t)," "),W.Db(3),W.Oc(" ",W.kc(35,21,"Address")," "),W.Db(3),W.Oc(" ",t.deliveryAddress," "),W.Db(2),W.rc("ngIf",!("COMPLETED"==t.ostatus||"CANCELLED"==t.ostatus)),W.Db(1),W.rc("currentvalue",t.ostatus)("orderstatus",n.ygen.orderstatus),W.Db(2),W.rc("mobile",t.orderByPhone)}}function N(t,e){if(1&t&&(W.Wb(0,"div"),W.Kc(1,x,43,23,"ion-card",27),W.Mc(2),W.Vb()),2&t){const t=e.ngIf,n=W.ic();W.Db(1),W.rc("ngForOf",t),W.Db(1),W.Oc(" ",n.getTotal(t)," ")}}function R(t,e){if(1&t){const t=W.Xb();W.Wb(0,"ion-fab",44,45),W.Wb(2,"ion-fab-button"),W.Rb(3,"ion-icon",46),W.Vb(),W.Wb(4,"ion-fab-list",47),W.Wb(5,"ion-fab-button",48),W.ec("click",(function(){return W.Cc(t),W.ic().openSocial("Vimeo")})),W.Rb(6,"ion-icon",49),W.Vb(),W.Wb(7,"ion-fab-button",50),W.ec("click",(function(){return W.Cc(t),W.ic().openSocial("Instagram")})),W.Rb(8,"ion-icon",51),W.Vb(),W.Wb(9,"ion-fab-button",52),W.ec("click",(function(){return W.Cc(t),W.ic().openSocial("Twitter")})),W.Rb(10,"ion-icon",53),W.Vb(),W.Wb(11,"ion-fab-button",54),W.ec("click",(function(){return W.Cc(t),W.ic().openSocial("Facebook")})),W.Rb(12,"ion-icon",55),W.Vb(),W.Vb(),W.Vb()}}let T=(()=>{class t{constructor(t,e,n,o,i,a,c,r,s,b,d,l,g){this.modalCtrl=t,this.centerdb=e,this.loadingCtrl=n,this.router=o,this.yalert=i,this.ygen=a,this.ydataservice=c,this.ystorageservice=r,this.ypay=s,this.yds=b,this.ynoti=d,this.excelservice=l,this.events=g,this.queryText="",this.segment="NEW",this.segmenttotal=new Map,this.total=0,this.centerdb.currenttenant.subscribe(t=>{t&&(this.orderlist=new u.a(O.a.getpath()+"/shop/orders",this.ydataservice.getDatabase(),!0,null),this.setSegmentTotal(),this.myinbox=this.getData(this.segment))})}ngOnInit(){console.log("yeah....ngoninit")}ionViewWillEnter(){console.log("yeah....ion enter")}deleteNotice(t){this.orderlist.removefromList(t)}deleteOrders(t){this.orderlist.getListRefer().remove()}takeAcion(t,e){Object.assign(e,{ostatus:t.value}),this.orderlist.updateList(e),this.yalert.openSnackBar(`Order Status changed for [${e.sendorderid}]`,"Ok"),this.ynoti.orderstatuschange(`Order Status changed to [${t.value}] for [${e.sendorderid}]`,e)}putinprocess(t){Object.assign(t,{ostatus:"INPROCESS"}),this.orderlist.updateList(t),this.ynoti.orderstatuschange(`Order Status changed to [${t.ostatus}] for [${t.sendorderid}]`,t),this.events.publish("shop:alertsubscription",{})}completeorder(t){Object.assign(t,{ostatus:"COMPLETED"}),this.orderlist.updateList(t),this.ynoti.orderstatuschange(`Congratulation you Order Status changed to [${t.ostatus}] for [${t.sendorderid}]`,t)}getItemCount(t){return t.payload?t.payload.length:0}getTitle(t){return t.read?"Mark Unread":"Mark Read"}segmentChanged(t){console.log("segment",t),this.myinbox=this.getData(t.detail.value)}getData(t){return this.ygen.isAdmin()?this.getOrders(t):this.getMyOrders(t)}getOrders(t){return"NEW"===t?this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(t=>Object.assign({$key:t.payload.key},t.payload.val())).filter(e=>e.ostatus==t||!e.ostatus)),Object(p.a)(t=>t.reverse())):this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(t=>Object.assign({$key:t.payload.key},t.payload.val())).filter(e=>e.ostatus==t)),Object(p.a)(t=>t.reverse()))}getMyOrders(t){return"NEW"===t?this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(t=>Object.assign({$key:t.payload.key},t.payload.val())).filter(e=>(e.ostatus==t||!e.ostatus)&&e.orderedBy==this.ygen.getUid())),Object(p.a)(t=>t.reverse())):this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(e=>e.map(t=>Object.assign({$key:t.payload.key},t.payload.val())).filter(e=>e.ostatus==t&&e.orderedBy==this.ygen.getUid())),Object(p.a)(t=>t.reverse()))}getTotal(t){this.total=0,t.forEach(t=>{this.total=this.total+t.amount})}setSegmentTotal(){this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(t=>Object.assign({$key:t.payload.key},t.payload.val())))).subscribe(t=>{this.ygen.orderstatus.forEach(e=>{this.segmenttotal.set(e.value,t.filter(t=>t.ostatus==e.value).length)})})}navigate(t,e){console.log()}downloadOrders(){let t=this.orderlist.getListRefer().snapshotChanges().pipe(Object(p.a)(t=>t.map(t=>Object.assign({$key:t.payload.key},t.payload.val())))).subscribe(e=>{console.log("list",e);let n=[];e.forEach(t=>{let e={orderid:t.sendorderid,amount:t.amount,paymentmethod:t.paymentmethod,deliveryAddress:t.deliveryAddress,name:t.orderByName,phone:t.orderByPhone,orderstatus:t.ostatus,dateoforder:this.ygen.formatTimestampToDate(t.odt),orderitems:this.getpayload(t.payload),paymentstatus:this.paymentdone(t),payment_id:this.paymentid(t)};n.push(e)}),0==n.length?this.yalert.openSnackBar("No orders for downlowd","Ok"):(this.excelservice.exportAsExcelFile(n,"orders"),this.yalert.openSnackBar("Orders will be downloaded...","Ok")),t.unsubscribe()})}getpayload(t){let e="";return t.forEach(t=>{e=e+t.title+"| "+t.description+"| Rs="+t.price+"| Total Items=["+t.orderqty+"] ||"}),e}paymentdone(t){let e="NOT PAID";return t.paymentResponse&&"Success"==t.paymentResponse.order_status&&(e="PAID"),e}paymentid(t){let e="";return t.paymentResponse&&(e=t.paymentResponse.payment_id),e}openSocial(t){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield this.loadingCtrl.create({message:`Posting to ${t}`,duration:1e3*Math.random()+500});yield e.present(),yield e.onWillDismiss()}))}}return t.\u0275fac=function(e){return new(e||t)(W.Qb(c.kb),W.Qb(O.a),W.Qb(c.ib),W.Qb(a.j),W.Qb(h.a),W.Qb(s.a),W.Qb(b.a),W.Qb(d.a),W.Qb(g.a),W.Qb(l.a),W.Qb(f.a),W.Qb(y.a),W.Qb(m.a))},t.\u0275cmp=W.Kb({type:t,selectors:[["app-ordermanagement"]],decls:52,vars:34,consts:[[3,"color"],["slot","start"],["slot","end","color","secondary"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent",4,"ngIf"],["class","download","color","danger",3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],[3,"ngModel","ngModelChange","ionChange"],["value","NEW"],["color","danger"],["value","INPROCESS"],["color","dark"],["value","COMPLETED"],["color","success"],["value","CANCELLED"],["color","tertiary"],[3,"color",4,"ngIf"],["padding",""],["loading",""],[4,"ngIf","ngIfElse"],["slot","fixed","vertical","bottom","horizontal","end",4,"ngIf"],[1,"footerCartSection"],[3,"icon","askquestion","icontext","isiconwithtext","actionEvent"],["color","danger",1,"download",3,"click"],["slot","icon-only","name","code-download"],[3,"ngModel","placeholder","ngModelChange"],["type","indeterminate","reversed","true"],[4,"ngFor","ngForOf"],["class","paySection",4,"ngIf"],["class","codSection",4,"ngIf"],["color","secondary",3,"click"],["name","eye"],["color","primary",3,"click"],[1,"contentorder"],[1,"labelt"],[1,"valuet"],["icon","delete","message","delete",3,"actionEvent",4,"ngIf"],[3,"currentvalue","orderstatus","actionEvent"],[2,"padding","5px"],[3,"mobile"],[1,"paySection"],["text-uppercase","",1,"sc-ion-label-md-h","sc-ion-label-md-s","hydrated"],[1,"codSection"],["icon","delete","message","delete",3,"actionEvent"],["slot","fixed","vertical","bottom","horizontal","end"],["fab",""],["name","glasses-outline"],["side","top"],["color","success",3,"click"],["name","logo-whatsapp"],["color","instagram",3,"click"],["name","bar-chart-outline"],["color","twitter",3,"click"],["name","calendar-outline"],["color","facebook",3,"click"],["name","today-outline"]],template:function(t,e){if(1&t&&(W.Wb(0,"ion-header"),W.Wb(1,"ion-toolbar",0),W.Wb(2,"ion-buttons",1),W.Rb(3,"ion-back-button"),W.Vb(),W.Wb(4,"ion-title"),W.Mc(5),W.jc(6,"translate"),W.Vb(),W.Wb(7,"ion-buttons",2),W.Kc(8,D,1,4,"app-appicon",3),W.Kc(9,E,2,0,"ion-button",4),W.Wb(10,"ion-button",5),W.ec("click",(function(){return e.ygen.routeto("searchorder",{})})),W.Rb(11,"ion-icon",6),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Wb(12,"ion-header"),W.Wb(13,"ion-toolbar",0),W.Wb(14,"ion-segment",7),W.ec("ngModelChange",(function(t){return e.segment=t}))("ionChange",(function(t){return e.segmentChanged(t)})),W.Wb(15,"ion-segment-button",8),W.Mc(16),W.jc(17,"translate"),W.Wb(18,"ion-badge",9),W.Mc(19),W.Vb(),W.Vb(),W.Wb(20,"ion-segment-button",10),W.Mc(21),W.jc(22,"translate"),W.Wb(23,"ion-badge",11),W.Mc(24),W.Vb(),W.Vb(),W.Wb(25,"ion-segment-button",12),W.Mc(26),W.jc(27,"translate"),W.Wb(28,"ion-badge",13),W.Mc(29),W.Vb(),W.Vb(),W.Wb(30,"ion-segment-button",14),W.Mc(31),W.jc(32,"translate"),W.Wb(33,"ion-badge",15),W.Mc(34),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Kc(35,S,3,5,"ion-toolbar",16),W.Vb(),W.Wb(36,"ion-content",17),W.Kc(37,w,1,0,"ng-template",null,18,W.Lc),W.Kc(39,N,3,2,"div",19),W.jc(40,"async"),W.Kc(41,R,13,0,"ion-fab",20),W.Vb(),W.Wb(42,"ion-footer"),W.Wb(43,"ion-toolbar"),W.Wb(44,"div",21),W.Wb(45,"ion-text"),W.Wb(46,"h3"),W.Mc(47),W.jc(48,"translate"),W.Vb(),W.Vb(),W.Wb(49,"ion-text"),W.Wb(50,"h3"),W.Mc(51),W.Vb(),W.Vb(),W.Vb(),W.Vb(),W.Vb()),2&t){const t=W.zc(38);W.Db(1),W.rc("color","warning"),W.Db(4),W.Nc(W.kc(6,20,"Order Management")),W.Db(3),W.rc("ngIf",e.ygen.isAdmin()),W.Db(1),W.rc("ngIf",e.ygen.isAdmin()),W.Db(4),W.rc("color","warning"),W.Db(1),W.rc("ngModel",e.segment),W.Db(2),W.Oc(" ",W.kc(17,22,"New"),""),W.Db(3),W.Nc(e.segmenttotal.get("NEW")),W.Db(2),W.Oc(" ",W.kc(22,24,"InProcess"),""),W.Db(3),W.Nc(e.segmenttotal.get("INPROCESS")),W.Db(2),W.Oc(" ",W.kc(27,26,"Completed"),""),W.Db(3),W.Nc(e.segmenttotal.get("COMPLETED")),W.Db(2),W.Oc(" ",W.kc(32,28,"Cancelled"),""),W.Db(3),W.Nc(e.segmenttotal.get("CANCELLED")),W.Db(1),W.rc("ngIf",0),W.Db(4),W.rc("ngIf",W.kc(40,30,e.myinbox))("ngIfElse",t),W.Db(2),W.rc("ngIf",!1),W.Db(6),W.Nc(W.kc(48,32,"Total")),W.Db(4),W.Oc(" \u20b9 ",e.total," ")}},directives:[c.y,c.fb,c.j,c.f,c.g,c.db,o.m,c.i,c.z,c.R,c.rb,i.o,i.r,c.S,c.h,c.s,c.w,c.ab,v.a,c.Q,c.sb,c.N,o.l,c.k,c.m,c.n,c.o,c.q,c.H,c.l,c.B,V.a,k.a,C.a,c.t,c.u,c.v],pipes:[M.c,o.b],styles:[".otitle[_ngcontent-%COMP%]{font-size:14px}.orderid[_ngcontent-%COMP%]{font-size:10px}.orderamt[_ngcontent-%COMP%]{font-size:18px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:0}tbody[_ngcontent-%COMP%]{font-size:small}.labelt[_ngcontent-%COMP%]{font-weight:lighter}.valuet[_ngcontent-%COMP%]{padding-left:10px}ion-card-content[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.footerCartSection[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.paySection[_ngcontent-%COMP%]{background:#15bf15}.codSection[_ngcontent-%COMP%], .paySection[_ngcontent-%COMP%]{color:#fff;position:absolute;padding:6px 16px;border-radius:5px;font-weight:700;right:10px}.codSection[_ngcontent-%COMP%]{background:#de66cf}ion-card-title[_ngcontent-%COMP%]{padding-bottom:0;background:#f5fffa}.download[_ngcontent-%COMP%]{font-size:30px;font-weight:700}ion-fab-button[_ngcontent-%COMP%]{--background:var(--ion-color-step-150,#fff);--background-hover:var(--ion-color-step-200,#f2f2f2);--background-focused:var(--ion-color-step-250,#d9d9d9);--color:var(--ion-color-primary,#3880ff)}.ios[_ngcontent-%COMP%]   ion-fab-button[_ngcontent-%COMP%]{--background-activated:var(--ion-color-step-250,#d9d9d9)}"]}),t})();var L=n("hVaU"),_=n("IZvt"),$=n("4pxM");const A=[{path:"",component:T}];let Q=(()=>{class t{}return t.\u0275mod=W.Ob({type:t}),t.\u0275inj=W.Nb({factory:function(e){return new(e||t)},imports:[[o.c,i.i,c.gb,L.a,_.a,$.a,a.n.forChild(A)]]}),t})()}}]);