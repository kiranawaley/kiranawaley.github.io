(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{oRaJ:function(t,e,i){"use strict";i.r(e),i.d(e,"UploadbrandsPageModule",(function(){return w}));var c=i("ofXK"),n=i("3Pt+"),o=i("TEn/"),a=i("tyNb"),s=i("OJQs"),r=i("DVUX"),l=i("fXoL"),d=i("P6Fj"),b=i("7pIB"),p=i("NFeN");function u(t,e){if(1&t){const t=l.Xb();l.Wb(0,"div"),l.Wb(1,"input",7,8),l.ec("change",(function(e){return l.Cc(t),l.ic().previewFile(e)})),l.Vb(),l.Wb(3,"button",9),l.ec("click",(function(){return l.Cc(t),l.zc(2).click()})),l.Wb(4,"mat-icon",10),l.Mc(5,"extension"),l.Vb(),l.Mc(6," Add Products Brands "),l.Vb(),l.Vb()}if(2&t){const t=l.ic();l.Db(1),l.rc("uploader",t.uploader)}}function h(t,e){if(1&t){const t=l.Xb();l.Wb(0,"div",11),l.Wb(1,"button",12),l.ec("click",(function(){return l.Cc(t),l.ic().clearAllItems()})),l.Wb(2,"mat-icon",10),l.Mc(3,"delete"),l.Vb(),l.Mc(4," Clear All Brands "),l.Vb(),l.Wb(5,"button",9),l.ec("click",(function(){return l.Cc(t),l.ic().saveAllItems()})),l.Wb(6,"mat-icon",10),l.Mc(7,"save"),l.Vb(),l.Mc(8," Save All Brands "),l.Vb(),l.Vb()}}function g(t,e){if(1&t&&l.Rb(0,"img",18),2&t){const t=l.ic().$implicit;l.rc("src",t.image,l.Ec)}}function f(t,e){if(1&t){const t=l.Xb();l.Wb(0,"div",19),l.Wb(1,"div",20),l.Wb(2,"app-appicon",21),l.ec("actionEvent",(function(e){return l.Cc(t),l.ic(2).delete(e)})),l.Vb(),l.Vb(),l.Wb(3,"div",20),l.Wb(4,"app-appicon",22),l.ec("actionEvent",(function(){l.Cc(t);const e=l.ic().$implicit;return l.ic().save(e)})),l.Vb(),l.Vb(),l.Vb()}2&t&&(l.Db(2),l.rc("color","accent")("icon","delete")("askquestion",!0)("icontext","Delete Brand")("isiconwithtext",!0),l.Db(2),l.rc("color","accent")("icon","save")("icontext","Save Brand")("isiconwithtext",!0))}function m(t,e){if(1&t&&(l.Wb(0,"ion-col",13),l.Wb(1,"ion-card"),l.Kc(2,g,1,1,"img",14),l.Wb(3,"ion-item",15),l.Wb(4,"ion-label",16),l.Mc(5),l.Vb(),l.Vb(),l.Wb(6,"ion-card-content"),l.Mc(7),l.Vb(),l.Kc(8,f,5,9,"div",17),l.Vb(),l.Vb()),2&t){const t=e.$implicit,i=l.ic();l.Db(2),l.rc("ngIf",t.imageuploaded),l.Db(3),l.Oc(" ",t.title," "),l.Db(2),l.Oc(" ",t.description," "),l.Db(1),l.rc("ngIf",i.ygen.isAdmin())}}const v=[{path:"",component:(()=>{class t{constructor(t,e,i,c,n,o,a,s){this.centerdb=t,this.ycat=e,this.toast=i,this.ydata=c,this.ygen=n,this.papa=o,this.yalert=a,this.photoUploadService=s,this.clearme=!0,this.productlimit=50,this.products=[],this.uploader=s.getUploader(),s.getUploader().clearQueue(),s.getUploader().cancelAll()}ngOnInit(){this.centerdb.currenttenant.subscribe(t=>{this.crudList=new s.p(s.P.getpath()+"/shop/brands",this.ydata.getDatabase(),!0,this.ygen.getUid()),this.crudList.getList().subscribe(t=>{this.productlimit=t.length})})}previewFile(t){t.srcElement&&t.srcElement.files&&t.srcElement.files[0]&&(t.srcElement.files[0].name.includes(".csv")?(this.toast.pop("success","Got the event & processing "+t.target.files.length+" file","Ok"),this.toast.pop("warn","Reading files","Processing"),this.papa.parse(t.srcElement.files[0],{complete:(t,e)=>{t.errors.forEach(e=>t.data.splice(e.row,1)),t.data.forEach(t=>{t.uploaded=this.giveflag(t.uploaded),t.active=this.giveflag(t.active),t.imageuploaded=this.giveflag(t.imageuploaded);try{t.$key=JSON.parse(t.$key)}catch(e){console.error(t.$key,e)}}),this.products=t.data.filter(t=>!t.uploaded)},delimiter:",",header:!0})):this.yalert.errordata("Only CSV files are allowed"))}giveflag(t){return!!t&&"true"==t.toLowerCase()}saveAllItems(){this.yalert.openSnackBar("Saving All Brands at once","Ok"),this.products.forEach(t=>{let e=t.$key;this.ygen.canAddProducts()?this.saveupdate(t,e):console.log("Products will not be added")}),this.clearAllItems()}saveItem(t){this.saveupdate(t,t.$key)}saveupdate(t,e){this.ycat.recievedBrandListKeyVal[e]?this.crudList.updateList(t):this.crudList.addtolist(t)}delete(t){this.products=this.products.filter(e=>e.$key!=t.$key),this.yalert.openSnackBar("Product deleted","Ok")}save(t){this.saveItem(t),this.products=this.products.filter(e=>e.$key!=t.$key),this.yalert.openSnackBar("Product saved","Ok")}clearAllItems(){this.products.length=0,this.clearme=!1,setTimeout(()=>{this.clearme=!0},500)}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(s.P),l.Qb(s.O),l.Qb(r.d),l.Qb(s.Q),l.Qb(s.T),l.Qb(d.a),l.Qb(s.a),l.Qb(s.cb))},t.\u0275cmp=l.Kb({type:t,selectors:[["app-uploadbrands"]],decls:15,vars:6,consts:[[3,"color"],["slot","start"],["padding",""],[4,"ngIf"],["style","padding:5px",4,"ngIf"],[1,"productlist"],["class","dada",4,"ngFor","ngForOf"],["hidden","","type","file","ng2FileSelect","",3,"uploader","change"],["productsFileInput",""],[1,"mat-raised-button","mat-primary",3,"click"],["color","warm",1,"pointer"],[2,"padding","5px"],[1,"mat-raised-button","mat-secondary",3,"click"],[1,"dada"],["class","imageshow",3,"src",4,"ngIf"],["button",""],[1,"ion-text-wrap"],["class","bcontainer",4,"ngIf"],[1,"imageshow",3,"src"],[1,"bcontainer"],[1,"bitems"],[3,"color","icon","askquestion","icontext","isiconwithtext","actionEvent"],[3,"color","icon","icontext","isiconwithtext","actionEvent"]],template:function(t,e){1&t&&(l.Wb(0,"ion-header"),l.Wb(1,"ion-toolbar",0),l.Wb(2,"ion-buttons",1),l.Rb(3,"ion-back-button"),l.Vb(),l.Wb(4,"ion-title"),l.Mc(5,"Upload Product Brands"),l.Vb(),l.Vb(),l.Vb(),l.Wb(6,"ion-content",2),l.Kc(7,u,7,1,"div",3),l.Kc(8,h,9,0,"div",4),l.Wb(9,"ion-item"),l.Mc(10),l.Vb(),l.Rb(11,"div",5),l.Wb(12,"ion-grid"),l.Wb(13,"ion-row"),l.Kc(14,m,9,4,"ion-col",6),l.Vb(),l.Vb(),l.Vb()),2&t&&(l.Db(1),l.rc("color","warning"),l.Db(6),l.rc("ngIf",e.clearme),l.Db(1),l.rc("ngIf",e.products.length>0),l.Db(2),l.Pc(' You are using "',e.ygen.getSubscriptionType(),'" subscription; You can add max ',e.ygen.maxproductsCanAdded()," Brands; "),l.Db(4),l.rc("ngForOf",e.products))},directives:[o.y,o.hb,o.j,o.f,o.g,o.fb,o.s,c.m,o.D,o.x,o.R,c.l,b.a,p.a,o.r,o.k,o.J,o.l,s.f],styles:[".bbcontainer[_ngcontent-%COMP%]{width:100%}.bbcontainer[_ngcontent-%COMP%], .bcontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}"]}),t})()}];let y=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(e){return new(e||t)},imports:[[a.n.forChild(v)],a.n]}),t})(),w=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(e){return new(e||t)},imports:[[c.c,n.j,o.ib,s.H,s.o,s.b,b.b,y]]}),t})()}}]);