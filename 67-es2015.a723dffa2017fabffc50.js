(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{G31D:function(e,t,a){"use strict";a.r(t),a.d(t,"TenantnewPageModule",(function(){return k}));var n=a("ofXK"),i=a("3Pt+"),s=a("tyNb"),o=a("TEn/"),r=a("D+2S"),c=a("sH8K"),h=a("DzsY"),l=a("0nTO"),p=a("mLjM"),d=a("+DAS"),b=a("DVUX"),u=a("YKLQ"),m=a("gAVi"),g=a("2Vo4"),w=a("fXoL"),y=a("Wp6s"),v=a("iEmi");function f(e,t){if(1&e){const e=w.Xb();w.Wb(0,"yogagainv2-dyanamic-page",3),w.ec("actionEvent",(function(t){return w.Cc(e),w.ic().send(t)}))("cancelEvent",(function(t){return w.Cc(e),w.ic().cancel(t)})),w.Vb()}if(2&e){const e=w.ic();w.rc("captchaOn",e.needcaptcha)("captchaName","tenantcaptcha")("whatform",e.getmap())("whatformgroup",e.getformgroup())("whichbuttons",e.getmybuttons())}}let E=(()=>{class e{constructor(e,t,a,n,i,s,o,r,c,h){this.yovalservice=e,this.yobuilderservice=t,this.ynotification=a,this.ydataservice=n,this.toasterService=i,this.ydatashare=s,this.ystorageservice=o,this.router=r,this.route=c,this.cd=h,this.title="Register Kirana Shop",this.tenantlist=[],this.existskya=!0,this.whatcontrolsmap=new Map,this.clear=new g.a(!1),this.needcaptcha=!1,this.mybuttons=new Map,this.loadingindicator=!1,"/tenantedit"!==location.pathname&&(this.needcaptcha=!0,this.ystorageservice.removeItem(u.a.SELECTED_TENANT));const l=this.route.snapshot.paramMap.get("id");l||this.startObject(this.edittenant),this.clear.next(!1),l?(this.needcaptcha=!1,this.ydataservice.retrivedata("/tenantlist",l).subscribe(e=>{this.edittenant=e,this.edittenant.key=l,this.clear.next(!1),this.startObject(this.edittenant),setTimeout(()=>{this.clear.next(!0)})},e=>{console.log("error",e)},()=>{console.log("finished....")})):this.clear.next(!0),n.getTenants().subscribe(e=>{this.tenantlist=[],this.tenantlist.push(e)})}getmap(){return this.whatcontrolsmap}getformgroup(){return this.inwhatformgroup}getmybuttons(){return this.mybuttons}ngOnInit(){console.log("YdatashareService.SELECTED_TENANT",this.ystorageservice.getItem(u.a.SELECTED_TENANT))}startObject(e){e&&(this.title="Edit Community");let t=new Map,a=[],n=0;a[n]=new p.b(n,"tenantname","",p.a.text),a[n].placeholder="Enter Kirana Shop Name",a[n].hint="Its your tenanat Name, should be unique",n++,a[n]=new p.b(n,"tenantdescription","",p.a.textarea),a[n].placeholder="Enter Shop Description",n++,a[n]=new p.b(n,"registringname","",p.a.text),a[n].placeholder="Enter Your Name",n++,a[n]=new p.b(n,"registeringphone","",p.a.phone),a[n].placeholder="Enter Your Phone",n++,a[n]=new p.b(n,"registertingemail","",p.a.email),a[n].placeholder="Enter Your Email",n++,a[n]=new p.b(n,"address","",p.a.textarea),a[n].placeholder="Your Shop address",n++,a[n]=new p.b(n,"city","",p.a.text),a[n].placeholder="Your Shop City",n++,a[n]=new p.b(n,"state","",p.a.text),a[n].placeholder="Your Shop state",n++,a[n]=new p.b(n,"zip","",p.a.text),a[n].placeholder="Your Shop Pincode",n++,a[n]=new p.b(n,"tenantlogo","https://res.cloudinary.com/ideasyogi/image/upload/v1589964651/default_qkhcdj.jpg",p.a.image),a[n].placeholder="Shop Picture",n++,a[n]=new p.b(n,"tenantfire",'{"x":"X"}',p.a.textarea),a[n].placeholder="Database Config",a[n].enabled=!!e,a[n].showme=!!e,a[n].required=!!e,n++,a[n]=new p.b(n,"tenantcloud",'{"x":"X"}',p.a.textarea),a[n].placeholder="Image Config",a[n].enabled=!!e,a[n].showme=!!e,a[n].required=!!e,n++,a[n]=new p.b(n,"active",this.checkpresence(e,"active",!1),p.a.slidetoggle),a[n].placeholder="Active",a[n].enabled=!!e,a[n].showme=!!e,a[n].required=!1,n++,a[n]=new p.b(n,"approved",this.checkpresence(e,"approved",!1),p.a.slidetoggle),a[n].placeholder="Approved",a[n].enabled=!!e,a[n].showme=!!e,a[n].required=!1,n++,a[n]=new p.b(n,"inprocess",this.checkpresence(e,"inprocess",!0),p.a.slidetoggle),a[n].placeholder="InProgress",a[n].enabled=!!e,a[n].showme=!!e,a[n].required=!1,e&&(n++,a[n]=new p.b(n,"key",e.key,p.a.text),a[n].enabled=!0,a[n].showme=!1,a[n].required=!1),a.forEach(a=>{if(e){const n=e[a.name];a.whattype!==p.a.radio&&(a.value=n),t.set(a.name,a)}else t.set(a.name,a)}),this.inwhatformgroup=this.yobuilderservice.createFormGroup(t),this.whatcontrolsmap=this.yobuilderservice.createMap(t,this.inwhatformgroup);let i=new r.a("Cancel","cancel","cancel_presentation","secondary",!1),s=new r.a("Save","register","lock_open","primary",!1);this.mybuttons.set("Action2",s),this.mybuttons.set("Action1",i)}checkpresence(e,t,a){return e?e[t]:a}send(e){console.log("capturing events",e),this.edittenant?this.updateTenant(e.data.value):this.registerNewTenant(e.data.value)}cancel(e){this.router.navigateByUrl("/tenants")}updateTenant(e){console.log("updated tenant",e),this.ydataservice.updateTenant(e)}registerNewTenant(e){new Promise((t,a)=>{this.tenantlist&&this.tenantlist.forEach(a=>a.forEach(a=>{a.tenantname.toLowerCase()==e.tenantname.toLowerCase()&&(this.existskya=!0,t(!0)),this.existskya=!1,t(!1)}))}).then(t=>{t?this.toasterService.pop("error","Error","Already this name is taken, please use another one!"):(this.ydataservice.addTenant(e),this.ynotification.sendNotificationToAdmim(`New Tenant Added ${e.tenantname}`))})}ionViewDidLeave(){console.log("leaving"),this.ystorageservice.removeItem(u.a.SELECTED_TENANT)}}return e.\u0275fac=function(t){return new(t||e)(w.Qb(c.a),w.Qb(h.a),w.Qb(l.a),w.Qb(d.a),w.Qb(b.d),w.Qb(u.a),w.Qb(m.a),w.Qb(s.g),w.Qb(s.a),w.Qb(w.h))},e.\u0275cmp=w.Kb({type:e,selectors:[["app-tenantnew"]],decls:11,vars:4,consts:[["slot","start"],[1,"box"],[3,"captchaOn","captchaName","whatform","whatformgroup","whichbuttons","actionEvent","cancelEvent",4,"ngIf"],[3,"captchaOn","captchaName","whatform","whatformgroup","whichbuttons","actionEvent","cancelEvent"]],template:function(e,t){1&e&&(w.Wb(0,"ion-header"),w.Wb(1,"ion-toolbar"),w.Wb(2,"ion-buttons",0),w.Rb(3,"ion-menu-button"),w.Vb(),w.Wb(4,"ion-title"),w.Lc(5),w.Vb(),w.Vb(),w.Vb(),w.Wb(6,"ion-content"),w.Wb(7,"mat-card"),w.Wb(8,"mat-card-content",1),w.Jc(9,f,1,5,"yogagainv2-dyanamic-page",2),w.jc(10,"async"),w.Vb(),w.Vb(),w.Vb()),2&e&&(w.Db(5),w.Mc(t.title),w.Db(4),w.rc("ngIf",w.kc(10,2,t.clear)))},directives:[o.y,o.fb,o.j,o.L,o.db,o.s,y.a,y.d,n.m,v.a],pipes:[n.b],styles:[""]}),e})();var T=a("hVaU"),x=a("4pxM"),N=a("IZvt");const S=[{path:"",component:E}];let k=(()=>{class e{}return e.\u0275mod=w.Ob({type:e}),e.\u0275inj=w.Nb({factory:function(t){return new(t||e)},imports:[[n.c,i.i,o.gb,T.a,x.a,N.a,s.k.forChild(S)]]}),e})()}}]);